<div class="container px-4 py-4" style="max-width: 200%;">
  <form nz-form [formGroup]="filterForm">
    <div nz-row nzGutter="8" nzJustify="space-between">
      <nz-form-item nz-col nzSpan="8">
        <nz-form-label nzRequired> Date </nz-form-label>
        <nz-form-control>
          <nz-date-picker formControlName="timeRange"></nz-date-picker>
          <nz-select class="templateSelect" [ngModel]="" [ngModelOptions]="{ standalone: true }"
            (ngModelChange)="onTemplateChange($event)" nzPlaceHolder="Select Template">
            <nz-option *ngFor="let template of templates" nzValue="{{ template.id }},{{ template.name }}"
              nzLabel="{{ template.name }}"></nz-option>
          </nz-select>
          <template-settings (modalClosed)="onModalClose()" [templates]="templates" [columns]="columns"
            [selectedColumns]="[]" [templateNameValue]="templateNameValue"
            [activeTemplateId]="templateId"></template-settings>
        </nz-form-control>

      </nz-form-item>

      <div nz-col nzSpan="10">
        <button nz-button [nzType]="'primary'" (click)="onSubmit()" [disabled]="isLoading" class="mr-4">
          Search
        </button>
        <button nz-button (click)="resetForm()" class="mr-4">Clear</button>
        <button nz-button (click)="exportexcel()">Export to Excel</button>
      </div>
    </div>
  </form>
  <!-- Event log table -->
  <div *ngIf="fetchTable$ | async"></div>
  <ng-template #indicatorTemplate><i nz-icon nzType="loading"></i></ng-template>
  <div class="progress" *ngIf="isLoading" >
    <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
  </div>
  <nz-table id="excel-table" #table [nzPageSize]="pageSize" 
    [nzFrontPagination]="paging" nzShowSizeChanger [nzData]="tableData" nzBordered
    [nzPageSizeOptions]="paginationValues" [nzScroll]="{ y: screenHeight }">
    <thead>
      <tr>
        <th *ngFor="let column of columnsVisible" [nzWidth]="column.width">{{ column.title }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of table.data; let i = index">
        <td *ngFor="let column of columnsVisible"
          [ngClass]="getClass(data[column.eventGroup+'StartNum'], 
            data[column.eventGroup+'DoneNum'], column.eventGroup)"
        >{{ data[column.dataName] }}</td>
      </tr>
    </tbody>
  </nz-table>
</div>