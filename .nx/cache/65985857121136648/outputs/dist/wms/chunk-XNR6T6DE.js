import{a as L}from"./chunk-D3GL3SK4.js";import{b as v,f as y}from"./chunk-6TITOEJA.js";import{a as I}from"./chunk-YPJKXAYS.js";import{a as o}from"./chunk-I3G2JKLN.js";import{i as _}from"./chunk-LCEARWCQ.js";import{a as h}from"./chunk-4AGTE6D3.js";import{a as g}from"./chunk-PLQ7TNCQ.js";import{Aa as e,a as f,b as u,na as r,qa as c,va as m}from"./chunk-N7LPRJLK.js";var T=(()=>{let i=class i{constructor(t,n,a,d,p,N){this._insertLog=t,this._verifyContainer=n,this._updateInventory=a,this._itn=d,this._userInfo=p,this._eventLog=N}sortingStart$(t){return this._itn.verifyITN$(t).pipe(r(()=>{let n={UserName:this._userInfo.userName,UserEventID:o.Event_Stocking_SortingStart,InventoryTrackingNumber:t,PartNumber:this._itn.itnInfo().PartNumber,ProductCode:this._itn.itnInfo().ProductCode,Quantity:this._itn.itnInfo().QuantityOnHand,Message:""};return this._eventLog.initEventLog({UserName:this._userInfo.userName,EventTypeID:o.Event_Stocking_SortingStart,Log:JSON.stringify({InventoryTrackingNumber:t,PartNumber:this._itn.itnInfo().PartNumber,ProductCode:this._itn.itnInfo().ProductCode,QuantityOnHand:this._itn.itnInfo().QuantityOnHand,Velocity:this._itn.itnInfo().Velocity})}),this._insertLog.mutate({oldLogs:n,eventLogs:this._eventLog.eventLog})}))}moveItn$(t){return this._verifyContainer.fetch({Barcode:t,DistributionCenter:g.DistributionCenter},{fetchPolicy:"network-only"}).pipe(c(n=>{if(!n.data.findContainer._id)throw new Error("Container not found!");if(!n.data.findContainer.ContainerType.IsMobile)throw new Error("This container is not a mobile container")}),r(()=>this._updateInventory.mutate({User:this._userInfo.userName,ITN:this._itn.itnInfo().ITN,BinLocation:t})),r(()=>{let n={UserName:this._userInfo.userName,UserEventID:o.Event_Stocking_SortingDone,ProductCode:this._itn.itnInfo().ProductCode,PartNumber:this._itn.itnInfo().PartNumber,Quantity:this._itn.itnInfo().QuantityOnHand,InventoryTrackingNumber:this._itn.itnInfo().ITN,Message:t},a=u(f({},this._eventLog.eventLog),{EventTypeID:o.Event_Stocking_SortingDone,Log:JSON.stringify(u(f({},JSON.parse(this._eventLog.eventLog.Log)),{Location:t}))});return this._insertLog.mutate({oldLogs:n,eventLogs:a})}))}};i.\u0275fac=function(n){return new(n||i)(e(_),e(v),e(y),e(L),e(h),e(I))},i.\u0275prov=m({token:i,factory:i.\u0275fac});let s=i;return s})();export{T as a};
