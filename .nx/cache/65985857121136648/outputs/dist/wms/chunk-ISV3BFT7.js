import{a as z}from"./chunk-G2ZMXMZ4.js";import{a as q}from"./chunk-D3GL3SK4.js";import"./chunk-6TITOEJA.js";import"./chunk-CNRANGED.js";import{a as Y}from"./chunk-GKR6SDXW.js";import{a as P}from"./chunk-E3B4WDOA.js";import{a as A}from"./chunk-XHQXBUEX.js";import"./chunk-RMIKNTFD.js";import"./chunk-D3FIXZL7.js";import"./chunk-ADHMVREX.js";import"./chunk-VJKYRYVM.js";import"./chunk-KSUYRJTQ.js";import"./chunk-YPJKXAYS.js";import"./chunk-I3G2JKLN.js";import"./chunk-LCEARWCQ.js";import"./chunk-4AGTE6D3.js";import"./chunk-5GWOD35Y.js";import"./chunk-POEXBOQJ.js";import{b as O}from"./chunk-MZCJXFXF.js";import{E as L,I as U,e as I,i as E,t as G}from"./chunk-L3THJMBJ.js";import"./chunk-PLQ7TNCQ.js";import"./chunk-C55YZZU5.js";import"./chunk-YUDS3XHK.js";import"./chunk-MIXZFVL7.js";import"./chunk-FFJ3QZ3H.js";import{i as D,k as V,n as j}from"./chunk-PJEV5NXI.js";import{A as B,q as $,w as R}from"./chunk-GWV5DZOT.js";import{$b as C,C as s,Da as b,Fb as l,Gb as r,Gc as y,H as h,Ia as g,Ja as v,Lc as M,Mc as w,Sb as p,V as _,ac as a,bc as m,dc as S,ec as N,gc as x,na as k,nc as d,pc as f,qa as T,xc as F}from"./chunk-N7LPRJLK.js";function J(o,n){if(o&1){let c=x();S(0),a(1,"popup-modal",5),d("clickSubmit",function(){g(c);let t=f();return v(t.popSubmit())})("clickCancel",function(){g(c);let t=f();return v(t.cancel())}),m(),N()}if(o&2){let c=f();l(1),p("message",c.message)}}var ct=(()=>{let n=class n{constructor(e,t,i,u,H){this._fb=e,this._actRoute=t,this._router=i,this._stock=u,this._itn=H,this.inputForm=this._fb.nonNullable.group({itn:["",[I.required,I.pattern(O)]]})}ngOnInit(){this.data$=s(!0)}onSubmit(){let e=this.inputForm.value.itn.trim();this.inputForm.patchValue({itn:""});let t=this._stock.ITNList().find(i=>i.ITN===e);if(!t){this.message=`${e} is not found, do you want to move it to your personal container?`;return}this._stock.addVerifiedItns(t),this.data$=s({error:{message:`ITN ${e} is found`,name:"success"}})}moveItnToUser(e){this.data$=this._itn.verifyITN$(e).pipe(k(()=>this._stock.moveItnToUser(e)),T(()=>this.message=null),h(()=>({error:{message:`${e} is not found in the working location,  It has been moved to your personal location.`,name:"warning"}})),_(t=>(this.message=null,s({error:{message:t.message,name:"error"}}))))}onBack(){this._router.navigate(["../itncount"],{relativeTo:this._actRoute})}onDone(){let e=this._stock.verifiedItns()?.length||0,t=this._stock.ITNList().length;if(e===t){this._router.navigate(["../checkitns"],{relativeTo:this._actRoute});return}this.message=`You are about to declare ${t-e} ITNs as NOT FOUND.
    Continue?`}popSubmit(){if(this.message.substring(0,3)==="You"){this.notFound();return}this.moveItnToUser(this.message.substring(0,10))}notFound(){let e;this._stock.verifiedItns()?.length?e=this._stock.ITNList().filter(t=>!this._stock.verifiedItns().some(i=>i.ITN===t.ITN)):e=this._stock.ITNList(),this.data$=this._stock.addNotFoundFlag$(e).pipe(h(()=>{let t="../checkitns";this._stock.verifiedItns()?.length||(t="../scantarget"),this._router.navigate([t],{relativeTo:this._actRoute})}),_(t=>{let i="../checkitns";return this._stock.verifiedItns()?.length||(i="../scantarget"),this._router.navigate([i],{relativeTo:this._actRoute}),s({error:{message:t.message,name:"error"}})}))}cancel(){this.message=null}};n.\u0275fac=function(t){return new(t||n)(r(L),r(D),r(V),r(z),r(q))},n.\u0275cmp=b({type:n,selectors:[["ng-component"]],standalone:!0,features:[y],decls:7,vars:5,consts:[[1,"flex","justify-center","font-bold","text-red-500","lg:text-4xl"],["controlName","itn","title","Scan ITN:",3,"data","formGroup","formSubmit","formBack"],[1,"absolute","bottom-5","grid","h-12","w-full","grid-cols-3","text-base","sm:h-16","md:mx-16","md:mt-6","md:h-24","md:text-2xl","lg:bottom-10","lg:h-36","lg:text-4xl"],["buttonText","Done",1,"col-span-2",3,"buttonClick"],[4,"ngIf"],[3,"message","clickSubmit","clickCancel"]],template:function(t,i){t&1&&(a(0,"h1",0),F(1," ITN Count Mismatch "),m(),a(2,"single-input-form",1),d("formSubmit",function(){return i.onSubmit()})("formBack",function(){return i.onBack()}),M(3,"async"),m(),a(4,"div",2)(5,"green-button",3),d("buttonClick",function(){return i.onDone()}),m()(),C(6,J,2,1,"ng-container",4)),t&2&&(l(2),p("data",w(3,3,i.data$))("formGroup",i.inputForm),l(4),p("ngIf",i.message))},dependencies:[B,$,R,j,A,U,E,G,P,Y],encapsulation:2,changeDetection:0});let o=n;return o})();export{ct as MismatchComponent};
