import{a as de}from"./chunk-F2JRIFI4.js";import"./chunk-ZL6MQR3Z.js";import{a as se}from"./chunk-XMFOCRFG.js";import"./chunk-JC3J4WKG.js";import{a as ne}from"./chunk-5DKNJ5MR.js";import{a as ie}from"./chunk-W6X5OBKE.js";import"./chunk-PTORZITP.js";import"./chunk-N327C62I.js";import{a as ae}from"./chunk-E3B4WDOA.js";import"./chunk-RMIKNTFD.js";import{a as le}from"./chunk-D3FIXZL7.js";import"./chunk-ADHMVREX.js";import{a as te}from"./chunk-IPTX4HSO.js";import{a as re}from"./chunk-VJKYRYVM.js";import{a as oe}from"./chunk-OQTOI2SX.js";import"./chunk-O3UEHWS5.js";import"./chunk-KSUYRJTQ.js";import"./chunk-FBU3NLE2.js";import"./chunk-MFWTQF6C.js";import"./chunk-M47XUQY5.js";import"./chunk-YPJKXAYS.js";import"./chunk-I3G2JKLN.js";import"./chunk-LCEARWCQ.js";import"./chunk-4AGTE6D3.js";import"./chunk-5GWOD35Y.js";import"./chunk-MZCJXFXF.js";import{B as X,E as Y,H as Z,I as ee,d as P,e as b,h as G,i as U,m as k,p as K,q as z,t as H,u as J}from"./chunk-L3THJMBJ.js";import"./chunk-PLQ7TNCQ.js";import"./chunk-C55YZZU5.js";import{n as $}from"./chunk-MIXZFVL7.js";import"./chunk-FFJ3QZ3H.js";import{k as R}from"./chunk-PJEV5NXI.js";import{A as q,p as j,q as B,w as Q}from"./chunk-GWV5DZOT.js";import{$b as w,Ba as F,Da as O,Fb as s,Gb as h,Gc as V,H as I,Ia as p,Ja as f,Lc as E,Mc as N,Rb as A,Rc as D,Sb as u,Sc as M,Uc as W,ac as r,bc as l,cc as T,dc as y,ec as S,gc as x,nc as m,pc as c,xc as g,zc as C}from"./chunk-N7LPRJLK.js";var ue=["itn"];function me(a,d){if(a&1){let n=x();r(0,"div")(1,"div",9)(2,"div",10)(3,"input",11,12),m("ngModelChange",function(e){let o=p(n).index,_=c();return f(_.label.updateItnListQty(e,o))}),l(),r(5,"div",13)(6,"h1"),g(7),l(),r(8,"h1"),g(9),l()(),r(10,"button",14),m("click",function(){let i=p(n).index,o=c();return o.editWindow=!0,f(o.editingIndex=i)}),g(11," Edit "),l(),r(12,"button",15),m("click",function(e){let o=p(n).$implicit,_=c();return f(_.removeField(o,e))}),g(13," Delete "),l()()()()}if(a&2){let n=d.$implicit,t=d.index,e=c();s(3),u("formControlName",n.controlInstance.itn),A("id",n.controlInstance.itn),s(4),C("DateCode:",e.label.ITNList()[t].datecode,""),s(2),C("Country:",e.label.ITNList()[t].ISO3,"")}}function pe(a,d){if(a&1){let n=x();y(0),r(1,"edit-info",16),m("clickCancel",function(){p(n);let e=c();return f(e.editWindow=!1)})("clickSubmit",function(e){p(n);let i=c();return f(i.editInfo(e))}),l(),S()}if(a&2){let n=c();s(1),u("datecode",n.label.ITNList()[n.editingIndex].datecode)("ISO3",n.label.ITNList()[n.editingIndex].ISO3)}}function fe(a,d){if(a&1){let n=x();y(0),r(1,"auth-modal",17),m("clickClose",function(){p(n);let e=c();return f(e.authWindow=!1)})("passAuth",function(){p(n);let e=c();return f(e.nextPage())}),l(),S()}if(a&2){let n=c();s(1),u("message",n.message)}}var Me=(()=>{let d=class d{constructor(t,e,i,o,_){this.updateInfo=t,this.receipt=e,this._fb=i,this._router=o,this._step=_,this.editingIndex=0,this.authWindow=!1,this.message="",this.editWindow=!1,this.listOfControl=[],this.label=F(ne),this.inputForm=this._fb.group({}),this.initList(),this.validator$=this.inputForm.valueChanges.pipe(I(v=>{let L=0;return Object.values(v).forEach((ce,ge)=>{L+=Number(ce)}),this.receipt.ExpectQuantity()-L}),I(v=>v!==0||this.inputForm.invalid))}ngOnInit(){this._step.changeSteps(3)}splitInteger(t,e){return[]}initList(){this.label.initItnList(),this.label.ITNList().map((t,e)=>{this.inputForm.addControl(`itn${e}`,new k(t.quantity,[b.required,b.min(1)])),this.listOfControl.push({id:e,controlInstance:{itn:`itn${e}`}})})}addField(t){t&&t.preventDefault();let e=this.listOfControl.length>0?this.listOfControl[this.listOfControl.length-1].id+1:0,i={id:e,controlInstance:{itn:`itn${e}`}};this.label.insertNewItn();let o=this.listOfControl.push(i);this.inputForm.addControl(this.listOfControl[o-1].controlInstance.itn,new k(0,[b.required,b.min(1)])),setTimeout(()=>{this.inputFiledList.get(this.listOfControl.length-1).nativeElement.select()},0)}removeField(t,e){if(e.preventDefault(),this.listOfControl.length>1){let i=this.listOfControl.indexOf(t);this.listOfControl.splice(i,1),this.label.removeItn(i),this.inputForm.removeControl(t.controlInstance.itn)}}onSubmit(){if(this.inputForm.valid){let t=[];if(Object.values(this.inputForm.value).forEach((e,i)=>{t.push(Number(e))}),this.label.ITNList().some(e=>e.datecode==="")&&this.updateInfo.receiptInfo.DateCode!==""){this.authWindow=!0,this.message="Allow empty DateCode!";return}if(this.label.ITNList().some(e=>e.ISO3==="UNK")&&this.updateInfo.receiptInfo.ISO3!=="UNK"){this.authWindow=!0,this.message="Allow unknown country code!";return}this.nextPage()}else Object.values(this.inputForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}editInfo(t){this.label.updateItnlistInfo(t,this.editingIndex),this.editWindow=!1}nextPage(){this._router.navigateByUrl("receiptreceiving/label/printitn")}onBack(){this._router.navigateByUrl("receiptreceiving/update/itncount")}};d.\u0275fac=function(e){return new(e||d)(h(ie),h(te),h(Y),h(R),h(oe))},d.\u0275cmp=O({type:d,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&M(ue,5),e&2){let o;D(o=W())&&(i.inputFiledList=o)}},standalone:!0,features:[V],decls:18,vars:10,consts:[[1,"grid","grid-cols-3","gap-5","text-xl"],[3,"formGroup"],[1,"grid","grid-cols-1","gap-5","lg:grid-cols-2"],[4,"ngFor","ngForOf"],[1,"mt-8","grid","h-16","w-full","grid-cols-4","gap-6","md:h-32","md:text-4xl"],["buttonText","Add Label",3,"buttonClick"],["buttonText","Verify",3,"disabled","buttonClick"],[3,"buttonClick"],[4,"ngIf"],[1,"relative"],[1,"grid","grid-cols-4","gap-2"],["type","number","placeholder","Quantity","required","",1,"w-full","rounded-lg","border","border-gray-300","bg-gray-50","p-2","text-2xl","text-gray-900","focus:border-blue-500","focus:ring-blue-500","dark:border-gray-600","dark:bg-gray-700","dark:text-white","dark:placeholder-gray-400","dark:focus:border-blue-500","dark:focus:ring-blue-500",3,"formControlName","ngModelChange"],["itn",""],[1,"grid","grid-rows-2","text-lg"],[1,"rounded-lg","bg-green-500","px-4","py-2","font-medium","text-white","hover:bg-green-800","focus:outline-none","focus:ring-4","focus:ring-green-300","dark:focus:ring-green-800",3,"click"],[1,"bottom-2.5","right-2.5","rounded-lg","bg-red-500","px-4","py-2","font-medium","text-white","hover:bg-red-800","focus:outline-none","focus:ring-4","focus:ring-red-300","dark:focus:ring-red-800",3,"click"],[3,"datecode","ISO3","clickCancel","clickSubmit"],[3,"message","clickClose","passAuth"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"h1"),g(2),l(),r(3,"h1"),g(4),l(),r(5,"h1"),g(6),l()(),r(7,"form",1)(8,"div",2),w(9,me,14,4,"div",3),l(),r(10,"div",4)(11,"green-button",5),m("buttonClick",function(_){return i.addField(_)}),l(),T(12,"div"),r(13,"submit-button",6),m("buttonClick",function(){return i.onSubmit()}),E(14,"async"),l(),r(15,"normal-button",7),m("buttonClick",function(){return i.onBack()}),l()()(),w(16,pe,2,2,"ng-container",8)(17,fe,2,1,"ng-container",8)),e&2&&(s(2),C("Total: ",i.receipt.ExpectQuantity(),""),s(2),C("Remaining: ",i.label.remaining(),""),s(2),C("Open for POs: ",i.receipt.openQuantityForPOs(),""),s(1),u("formGroup",i.inputForm),s(2),u("ngForOf",i.listOfControl),s(4),u("disabled",N(14,8,i.validator$)),s(3),u("ngIf",i.editWindow),s(1),u("ngIf",i.authWindow))},dependencies:[q,j,B,Q,Z,K,P,z,G,U,X,ee,H,J,$,ae,le,re,se,de],encapsulation:2});let a=d;return a})();export{Me as AssignLabelComponent};
