import{a as Ci,b as tt}from"./chunk-J3DDCTFF.js";import{a as Si,b as gi,c as Xe}from"./chunk-4FHUFIPG.js";import{b as oi,c as ai,d as si,e as mi,f as di,g as li,h as ci,i as pi,j as ui,k as fi,l as Ze}from"./chunk-FBU3NLE2.js";import"./chunk-MFWTQF6C.js";import"./chunk-M47XUQY5.js";import{a as qt,b as Wt,c as Ke}from"./chunk-YNAUNBZ3.js";import{a as ze}from"./chunk-YPJKXAYS.js";import{a as Ee,b as Me,c as Oe,d as ie}from"./chunk-LNS7FH25.js";import{a as g}from"./chunk-I3G2JKLN.js";import{i as Ce,j as Xt,l as ei}from"./chunk-LCEARWCQ.js";import{a as te,b as F}from"./chunk-RH2D4KR5.js";import{a as fe}from"./chunk-4AGTE6D3.js";import"./chunk-5GWOD35Y.js";import{a as ti,b as ii,c as ni,d as ri,e as be}from"./chunk-POEXBOQJ.js";import{c as Ii,d as hi,e as Ni}from"./chunk-TREYRKOP.js";import{a as Je,b as De}from"./chunk-55MPF5EN.js";import{c as _i,d as vi,e as et}from"./chunk-6DLKQNDK.js";import{a as Yt,b as Jt,g as Zt}from"./chunk-MZCJXFXF.js";import{a as ee,b as Ye,c as ye,d as Te,e as G}from"./chunk-WUHPQNSG.js";import"./chunk-YGLVR5WL.js";import{a as Ae,d as X}from"./chunk-44NJU3LR.js";import"./chunk-Z347V25R.js";import{B as Kt,G as ve,H as J,I as Z,d as Ie,e as M,h as he,i as Ne,p as Se,r as $t,t as ge,u as _e}from"./chunk-L3THJMBJ.js";import"./chunk-RAQ4VAB7.js";import{b as Ht}from"./chunk-FMSTYN27.js";import"./chunk-QQPJAVIB.js";import"./chunk-RMC6N2HF.js";import"./chunk-GJX7JKAF.js";import"./chunk-WX6KJXZ2.js";import"./chunk-EXQESRXT.js";import"./chunk-5FUULRSO.js";import{a as w,b as Y,c as k}from"./chunk-V5UEWFGK.js";import{a as We}from"./chunk-PLQ7TNCQ.js";import"./chunk-C55YZZU5.js";import{a as jt}from"./chunk-E6LDBMP7.js";import{a as W,c as j,d as $,e as K,f as U}from"./chunk-GFVCXK67.js";import"./chunk-WOYNEQEU.js";import"./chunk-XSY6ZNJP.js";import"./chunk-W3KGMJG7.js";import"./chunk-B3MPBRHZ.js";import{c as Bt}from"./chunk-YUDS3XHK.js";import{k as Qt,l as Vt}from"./chunk-MIXZFVL7.js";import{r as xt}from"./chunk-FFJ3QZ3H.js";import{c as ue,i as $e,j as Ft,k as q,n as ft}from"./chunk-PJEV5NXI.js";import{A as je,p as pe,q as b,v as Gt,w as H}from"./chunk-GWV5DZOT.js";import{$b as h,Ac as Pt,C as re,D as Ct,Da as z,Ea as ce,Fa as yt,Fb as a,Gb as c,Gc as L,H as oe,Ha as Tt,Hc as qe,Ia as ae,Ib as bt,Ic as Ut,Ja as se,Lc as R,Mc as P,N as xe,Qc as wt,Rc as A,Sb as l,Sc as E,Tb as Be,Tc as kt,Ub as Mt,Uc as y,V as Q,a as x,aa as zt,ac as m,b as B,bc as d,cc as I,dc as Qe,ec as Ve,fc as Ot,g as de,gb as Et,gc as ke,j as we,m as vt,n as Fe,na as D,nc as _,oa as At,pc as S,qa as V,qc as Dt,rc as Lt,sc as Rt,tb as pt,tc as ut,w as ct,wa as le,xc as p,yc as C,zc as He}from"./chunk-N7LPRJLK.js";var T=class{constructor(){this._tabStatus=new Fe(["process","wait","wait","wait"]),this.tabStatus$=this._tabStatus.asObservable(),this._globalMessage=new Fe(null),this.globalMessage$=this._globalMessage.asObservable(),this._itemInfo=new Fe(null)}changeTab(t){this._tabStatus.next(t)}changeGlobalMessages(t){this._globalMessage.next(t)}get globalMessages(){return this._globalMessage.value}changeItemParams(t){this._itemInfo.next(t)}get itemInfo(){return this._itemInfo.value}};var nt=(()=>{let t=class t{constructor(r){this.qcService=r,this.tabStatus=["process","wait","wait","wait"],this.subscription=new de}ngOnInit(){this.subscription.add(this.qcService.tabStatus$.subscribe(r=>this.tabStatus=r))}ngOnDestroy(){this.subscription.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(c(T))},t.\u0275cmp=z({type:t,selectors:[["step-tabs"]],standalone:!0,features:[L],decls:5,vars:4,consts:[["nz-row","",1,"mb-4"],["nzTitle","Scan ITN","nzIcon","scan",3,"nzStatus"],["nzTitle","Global Messages","nzIcon","message",3,"nzStatus"],["nzTitle","Verification","nzIcon","solution",3,"nzStatus"],["nzTitle","Repack","nzStatus","wait","nzIcon","dropbox",3,"nzStatus"]],template:function(i,e){i&1&&(m(0,"nz-steps",0),I(1,"nz-step",1)(2,"nz-step",2)(3,"nz-step",3)(4,"nz-step",4),d()),i&2&&(a(1),l("nzStatus",e.tabStatus[0]),a(1),l("nzStatus",e.tabStatus[1]),a(1),l("nzStatus",e.tabStatus[2]),a(1),l("nzStatus",e.tabStatus[3]))},dependencies:[Xe,gi,Si,k,w],encapsulation:2});let n=t;return n})();var ki=["stepPage"];function Gi(n,t){if(n&1&&(Qe(0),m(1,"p"),p(2),d(),Ve()),n&2){let s=S(2);a(2),C(s.modalMessage)}}function Fi(n,t){if(n&1){let s=ke();m(0,"nz-modal",2),_("nzVisibleChange",function(i){ae(s);let e=S();return se(e.isModalVisible=i)})("nzOnOk",function(){ae(s);let i=S();return se(i.closeModal())}),h(1,Gi,3,1,"ng-container",3),d()}if(n&2){let s=S();l("nzVisible",s.isModalVisible)}}var ot=(()=>{let t=class t{constructor(r,i){this._title=r,this._printer=i,this.isModalVisible=!1,this.modalMessage="",this.title="Quality Control",this._title.update("Quality Control")}ngOnInit(){this.printerStation$=this._printer.printerStation$}closeModal(){this.isModalVisible=!1}};t.\u0275fac=function(i){return new(i||t)(c(jt),c(Ze))},t.\u0275cmp=z({type:t,selectors:[["quality-control"]],viewQuery:function(i,e){if(i&1&&E(ki,5),i&2){let o;A(o=y())&&(e.stepPage=o.first)}},decls:5,vars:3,consts:[[1,"container","mx-auto","px-2"],["nzTitle","The first Modal",3,"nzVisible","nzVisibleChange","nzOnOk",4,"ngIf"],["nzTitle","The first Modal",3,"nzVisible","nzVisibleChange","nzOnOk"],[4,"nzModalContent"]],template:function(i,e){i&1&&(m(0,"div",0),I(1,"step-tabs")(2,"router-outlet"),d(),h(3,Fi,2,1,"nz-modal",1),R(4,"async")),i&2&&(a(3),l("ngIf",P(4,1,e.printerStation$)))},dependencies:[b,Ft,hi,Ii,nt,H],encapsulation:2});let n=t;return n})();var xi=["ITN"];function Bi(n,t){if(n&1&&(m(0,"nz-form-item",2),I(1,"nz-alert",11),d()),n&2){let s=S();a(1),l("nzType",s.alertType==="error"?"error":s.alertType==="success"?"success":s.alertType==="info"?"info":"warning")("nzMessage",s.alertMessage)}}var at=(()=>{let t=class t{constructor(r,i,e,o,u,f,N,v,O){this.fb=r,this.router=i,this.route=e,this.titleService=o,this.qcService=u,this.logService=f,this.eventLog=N,this._userInfo=v,this.verifyITNQC=O,this.isLoading=!1,this.alertType="error",this.alertMessage="",this.subscription=new de,this.ITNForm=this.fb.group({ITN:["",[M.required,M.pattern(Jt)]]}),this.titleService.setTitle("qc/scanitn")}ngOnInit(){this.alertType=this.route.snapshot.queryParams.type,this.alertMessage=this.route.snapshot.queryParams.message,this.qcService.changeTab(["process","wait","wait","wait"]),this.logService.initEventLog({UserName:this._userInfo.userName,EventTypeID:g.Event_QC_Start,Log:""}),this.qcService.changeGlobalMessages(null),this.qcService.changeItemParams(null)}ngAfterViewInit(){setTimeout(()=>{this.ITNInput.nativeElement.select()})}onSubmit(){this.alertMessage="",!(this.ITNForm.invalid||this.isLoading)&&this.verfiyITN(this.ITNForm.get("ITN").value.trim().toUpperCase())}verfiyITN(r){this.isLoading=!0;let i=/^hld*/gi,e=/^autostore*/gi;this.subscription.add(this.verifyITNQC.fetch({InventoryTrackingNumber:r,DistributionCenter:We.DistributionCenter},{fetchPolicy:"network-only"}).pipe(V(o=>{if(!o.data.findInventory.ORDERLINEDETAILs?.length)throw"Can not find this order";if(o.data.findInventory.ORDERLINEDETAILs?.length>1)throw"Invalid Order Line Detail";let u="";if(![g.droppedQC_ID,g.warehouseHold_ID,g.qcComplete_ID].includes(o.data.findInventory.ORDERLINEDETAILs[0].StatusID)&&!o.data.findInventory.ORDERLINEDETAILs[0].BinLocation.trim().match(e)&&(u+=`Invalid order line status ${o.data.findInventory.ORDERLINEDETAILs[0].StatusID}. Must be 20, 30, or 60`),u)throw u}),D(o=>{let u=o.data.findInventory,f=o.data.findInventory.ORDERLINEDETAILs[0].Order,N=o.data.findInventory.ORDERLINEDETAILs[0].OrderLine;return this.itemInfo={InventoryTrackingNumber:r,InventoryID:u._id,OrderLineDetailID:u.ORDERLINEDETAILs[0]._id,OrderID:f._id,CustomerNumber:f.Customer?.CustomerNumber.trim()||"",DistributionCenter:f.DistributionCenter?.trim(),OrderNumber:f.OrderNumber?.trim(),NOSI:f.NOSINumber?.trim(),OrderLineNumber:N.OrderLineNumber,PartNumber:u.Product.PartNumber?.trim(),ProductCode:u.Product.ProductCode.ProductCodeNumber.trim(),Quantity:u.ORDERLINEDETAILs[0].Quantity,ParentITN:u.ParentITN?.trim()||"",ROHS:u.ROHS,DateCode:u.DateCode?.trim()||"",CountryISO2:u.Country?.ISO2||"",CountMethod:"",isHold:!!u.ORDERLINEDETAILs[0].BinLocation.toLowerCase().trim().match(i),CustomerTier:f.Customer?.CustomerTier,ProductTier:u.Product?.ProductTier,ShipmentMethod:f.ShipmentMethod._id,ShipmentMethodDescription:f.ShipmentMethod.ShippingMethod,WMSPriority:u.ORDERLINEDETAILs[0].WMSPriority,Priority:f.ShipmentMethod.PriorityPinkPaper},re(!0)}),D(()=>{let o=[{UserName:this._userInfo.userName,OrderNumber:this.itemInfo.OrderNumber,NOSINumber:this.itemInfo.NOSI,OrderLineNumber:this.itemInfo.OrderLineNumber,InventoryTrackingNumber:r,UserEventID:g.Event_QC_Start,CustomerNumber:this.itemInfo.CustomerNumber,CustomerTier:this.itemInfo.CustomerTier,DistributionCenter:this.itemInfo.DistributionCenter,PartNumber:this.itemInfo.PartNumber,ProductCode:this.itemInfo.ProductCode,ProductTier:this.itemInfo.ProductTier,Quantity:this.itemInfo.Quantity,ParentITN:this.itemInfo.ParentITN,ShipmentMethod:this.itemInfo.ShipmentMethod,ShipmentMethodDescription:this.itemInfo.ShipmentMethodDescription,WMSPriority:this.itemInfo.WMSPriority,Priority:this.itemInfo.Priority}];return this.logService.updateEventLog(B(x({},this.logService.eventLog),{Log:JSON.stringify({OrderNumber:this.itemInfo.OrderNumber,NOSINumber:this.itemInfo.NOSI,OrderLineNumber:this.itemInfo.OrderLineNumber,InventoryTrackingNumber:r,CustomerNumber:this.itemInfo.CustomerNumber,CustomerTier:this.itemInfo.CustomerTier,DistributionCenter:this.itemInfo.DistributionCenter,PartNumber:this.itemInfo.PartNumber,ProductCode:this.itemInfo.ProductCode,ProductTier:this.itemInfo.ProductTier,Quantity:this.itemInfo.Quantity,ParentITN:this.itemInfo.ParentITN,ShipmentMethod:this.itemInfo.ShipmentMethod,ShipmentMethodDescription:this.itemInfo.ShipmentMethodDescription,WMSPriority:this.itemInfo.WMSPriority,Priority:this.itemInfo.Priority})})),this.eventLog.mutate({oldLogs:o,eventLogs:this.logService.eventLog})})).subscribe({next:()=>{this.qcService.changeItemParams(this.itemInfo),this.router.navigate(["/qc/globalmessages"]),this.isLoading=!1},error:o=>{this.isLoading=!1,this.alertType="error",this.alertMessage=o,this.ITNInput.nativeElement.select()}}))}ngOnDestroy(){this.subscription.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(c(ve),c(q),c($e),c(ue),c(T),c(ze),c(Ce),c(fe),c(oi))},t.\u0275cmp=z({type:t,selectors:[["scan-itn"]],viewQuery:function(i,e){if(i&1&&E(xi,5),i&2){let o;A(o=y())&&(e.ITNInput=o.first)}},standalone:!0,features:[L],decls:15,vars:3,consts:[[1,"container","py-6"],["nz-form","","focusInvalidInput","",3,"formGroup","ngSubmit"],["nz-row","","nzJustify","center"],["nz-col","","nzXs","20","nzSm","16","nzMd","12","nzLg","10","nzXl","8","nzXXl","6"],["nzRequired",""],["nzHasFeedback","","nzErrorTip","The input is not valid ITN!"],["nz-input","","oninput","this.value = this.value.toUpperCase()","placeholder","PH03869239","nzSize","large","type","text","id","ITN","name","ITN","formControlName","ITN","autocomplete","off"],["ITN",""],["nz-col","","nzSpan","13"],["nz-button","","type","submit","nzType","primary","nzSize","large",1,"w-full",3,"nzLoading","click"],["nz-row","","nzJustify","center",4,"ngIf"],["nzShowIcon","",1,"w-full",3,"nzType","nzMessage"]],template:function(i,e){i&1&&(m(0,"div",0)(1,"form",1),_("ngSubmit",function(){return e.onSubmit()}),m(2,"div",2)(3,"div",3)(4,"nz-form-item",2)(5,"nz-form-label",4),p(6," ITN "),d(),m(7,"nz-form-control",5),I(8,"input",6,7),d()(),m(10,"nz-form-item",2)(11,"div",8)(12,"button",9),_("click",function(){return e.onSubmit()}),p(13," Submit "),d()()(),h(14,Bi,2,2,"nz-form-item",10),d()()()()),i&2&&(a(1),l("formGroup",e.ITNForm),a(11),l("nzLoading",e.isLoading),a(2),l("ngIf",e.alertMessage))},dependencies:[J,Se,Ie,he,Ne,G,Y,w,Ye,ee,Te,ye,Ee,Z,ge,_e,k,X,Ae,U,K,W,j,$,b,F,te],encapsulation:2});let n=t;return n})();var Qi=[{_id:1,name:"UNKNOWN"},{_id:2,name:"US: UNITED STATES"},{_id:3,name:"CA: CANADA"},{_id:4,name:"BJ: BENIN"},{_id:5,name:"AI: ANGUILLA"},{_id:6,name:"AG: ANTIGUA AND BARBUDA"},{_id:7,name:"PR: PUERTO RICO"},{_id:8,name:"KN: SAINT KITTS AND NEVIS"},{_id:9,name:"TT: TRINIDAD AND TOBAGO"},{_id:10,name:"TC: TURKS & CAICOS"},{_id:11,name:"LC: SAINT LUCIA"},{_id:12,name:"VC: ST. VINCENT & GRENADINES"},{_id:13,name:"BS: BAHAMAS"},{_id:14,name:"BM: BERMUDA"},{_id:15,name:"KY: CAYMAN ISLANDS"},{_id:16,name:"VG: VIRGIN ISLANDS, BRITISH"},{_id:17,name:"DM: DOMINICA"},{_id:18,name:"VI: VIRGIN ISLANDS, U.S."},{_id:19,name:"AX: ALAND ISLANDS"},{_id:20,name:"BV: BOUVET ISLAND"},{_id:21,name:"IO: BRITISH INDIAN OCEAN TERR"},{_id:22,name:"TF: FRENCH SOUTHERN TERR"},{_id:23,name:"GG: GUERNSEY"},{_id:24,name:"HM: HEARD/MCDONALD ISLANDS"},{_id:25,name:"VA: HOLY SEE (VATICAN CITY)"},{_id:26,name:"IM: ISLE OF MAN"},{_id:27,name:"JE: JERSEY"},{_id:28,name:"DO: DOMINICAN REPUBLIC"},{_id:29,name:"NU: NIUE"},{_id:30,name:"NF: NORFOLK ISLAND"},{_id:31,name:"MP: NORTHERN MARIANA ISLANDS"},{_id:32,name:"PW: PALAU"},{_id:33,name:"PS: PALESTINIAN TERRITORY"},{_id:34,name:"RE: REUNION"},{_id:35,name:"BL: SAINT BARTHELEMY"},{_id:36,name:"MF: SAINT MARTIN"},{_id:37,name:"PM: SAINT PIERRE AND MIQUELON"},{_id:38,name:"ST: SAO TOME AND PRINCIPE"},{_id:39,name:"GS: S.GEORGIA&S.SANDWICH IS."},{_id:40,name:"SJ: SVALBARD AND JAN MAYEN"},{_id:41,name:"TL: TIMOR-LESTE"},{_id:42,name:"TK: TOKELAU"},{_id:43,name:"WF: WALLIS AND FUTUNIA"},{_id:44,name:"EH: WESTERN SAHARA"},{_id:45,name:"UM: U.S. MINOR OUTLYING IS."},{_id:46,name:"JM: JAMAICA"},{_id:47,name:"MS: MONTSERRAT"},{_id:48,name:"EG: EGYPT"},{_id:49,name:"MA: MOROCCO"},{_id:50,name:"DZ: ALGERIA"},{_id:51,name:"TN: TUNISIA"},{_id:52,name:"LY: LIBYAN ARAB JAMAHIRIYA"},{_id:53,name:"GM: GAMBIA"},{_id:54,name:"SN: SENEGAL"},{_id:55,name:"MR: MAURITANIA"},{_id:56,name:"ML: MALI"},{_id:57,name:"GN: GUINEA"},{_id:58,name:"CI: COTE D'IVOIRE"},{_id:59,name:"BF: BUKINA FASO"},{_id:60,name:"NE: NIGER"},{_id:61,name:"TG: TOGO"},{_id:62,name:"MU: MAURITIUS"},{_id:63,name:"LR: LIBERIA"},{_id:64,name:"SL: SIERRA LEONE"},{_id:65,name:"GH: GHANA"},{_id:66,name:"NG: NIGERIA"},{_id:67,name:"TD: CHAD"},{_id:68,name:"CF: CENTRAL AFRICAN REPUBLIC"},{_id:69,name:"CM: CAMEROON"},{_id:70,name:"CV: CAPE VERDE ISLANDS"},{_id:71,name:"GQ: EQUATORIAL GUINEA"},{_id:72,name:"GA: GABON"},{_id:73,name:"CG: CONGO"},{_id:74,name:"CD: CONGO, DEM REP OF"},{_id:75,name:"AO: ANGOLA"},{_id:76,name:"GW: GUINEA-BISSAU"},{_id:77,name:"SC: SEYCHELLES"},{_id:78,name:"SD: SUDAN"},{_id:79,name:"RW: RWANDA"},{_id:80,name:"ET: ETHIOPIA"},{_id:81,name:"SO: SOMALIA"},{_id:82,name:"DJ: DJIBOUTI"},{_id:83,name:"KE: KENYA"},{_id:84,name:"TZ: TANZANIA"},{_id:85,name:"UG: UGANDA"},{_id:86,name:"BI: BURUNDI"},{_id:87,name:"MZ: MOZANBIQUE"},{_id:88,name:"ZM: ZAMBIA"},{_id:89,name:"MG: MADAGASCAR"},{_id:90,name:"ZW: ZIMBABWE"},{_id:91,name:"NA: NAMIBIA"},{_id:92,name:"MW: MALAWI"},{_id:93,name:"LS: LESOTHO"},{_id:94,name:"BW: BOTSWANA"},{_id:95,name:"SZ: SWAZILAND"},{_id:96,name:"KM: COMOROS"},{_id:97,name:"YT: MAYOTTE"},{_id:98,name:"ZA: SOUTH AFRICA"},{_id:99,name:"SH: SAINT HELENA"},{_id:100,name:"ER: ERITREA"},{_id:101,name:"AW: ARUBA"},{_id:102,name:"FO: FAROE ISLANDS"},{_id:103,name:"GL: GREENLAND"},{_id:104,name:"GR: GREECE"},{_id:105,name:"NL: NETHERLANDS"},{_id:106,name:"BE: BELGIUM"},{_id:107,name:"FR: FRANCE"},{_id:108,name:"MC: MONACO"},{_id:109,name:"ES: SPAIN"},{_id:110,name:"GI: GIBRALTAR"},{_id:111,name:"LU: LUXEMBOURG"},{_id:112,name:"IE: IRELAND"},{_id:113,name:"IS: ICELAND"},{_id:114,name:"AL: ALBANIA"},{_id:115,name:"MT: MALTA"},{_id:116,name:"CY: CYPRUS"},{_id:117,name:"FI: FINLAND"},{_id:118,name:"BG: BULGARIA"},{_id:119,name:"HU: HUNGARY"},{_id:120,name:"PT: PORTUGAL"},{_id:121,name:"LT: LITHUANIA"},{_id:122,name:"LV: LATVIA"},{_id:123,name:"EE: ESTONIA"},{_id:124,name:"MD: REPUBLIC OF MOLDOVA"},{_id:125,name:"AM: ARMENIA"},{_id:126,name:"BY: BELARUS"},{_id:127,name:"AD: ANDORRA"},{_id:128,name:"SM: SAN MARINO"},{_id:129,name:"UA: UKRAINE"},{_id:130,name:"RS: SERBIA"},{_id:131,name:"ME: MONTENEGRO"},{_id:132,name:"HR: CROATIA"},{_id:133,name:"SI: SLOVENIA"},{_id:134,name:"BA: BOSNIA HERZEGOVINA"},{_id:135,name:"MK: MACEDONIA"},{_id:136,name:"IT: ITALY"},{_id:137,name:"RO: ROMANIA"},{_id:138,name:"CH: SWITZERLAND"},{_id:139,name:"LI: LIECHTENSTEIN"},{_id:140,name:"CZ: CZECH REPUBLIC"},{_id:141,name:"SK: SLOVAKIA"},{_id:142,name:"AT: AUSTRIA"},{_id:143,name:"DK: DENMARK"},{_id:144,name:"SE: SWEDEN"},{_id:145,name:"NO: NORWAY"},{_id:146,name:"GD: GRENADA"},{_id:147,name:"PL: POLAND"},{_id:148,name:"DE: GERMANY"},{_id:149,name:"FK: FALKLAND ISLANDS"},{_id:150,name:"BZ: BELIZE"},{_id:151,name:"GT: GUATEMALA"},{_id:152,name:"SV: EL SALVADOR"},{_id:153,name:"HN: HONDURAS"},{_id:154,name:"NI: NICARAGUA"},{_id:155,name:"CR: COSTA RICA"},{_id:156,name:"PA: PANAMA"},{_id:157,name:"HT: HAITI"},{_id:158,name:"PE: PERU"},{_id:159,name:"MX: MEXICO"},{_id:160,name:"CU: CUBA"},{_id:161,name:"AR: ARGENTINA"},{_id:162,name:"BR: BRAZIL"},{_id:163,name:"CL: CHILE"},{_id:164,name:"CO: COLOMBIA"},{_id:165,name:"VE: VENEZUELA"},{_id:166,name:"GP: GUADELOUPE"},{_id:167,name:"BO: BOLIVIA"},{_id:168,name:"GY: GUYANA"},{_id:169,name:"EC: ECUADOR"},{_id:170,name:"GF: FRENCH GUIANA"},{_id:171,name:"PY: PARAGUAY"},{_id:172,name:"MQ: MARTINIQUE"},{_id:173,name:"SR: SURINAME"},{_id:174,name:"UY: URUGUAY"},{_id:175,name:"AN: NETHERLANDS ANTILLES"},{_id:176,name:"CW: CURACAO"},{_id:177,name:"MY: MALAYSIA"},{_id:178,name:"AU: AUSTRALIA"},{_id:179,name:"ID: INDONESIA"},{_id:180,name:"PH: PHILIPPINES"},{_id:181,name:"NZ: NEW ZEALAND"},{_id:182,name:"PN: PITCAIN ISLAND"},{_id:183,name:"SG: SINGAPORE"},{_id:184,name:"TH: THAILAND"},{_id:185,name:"GU: GUAM"},{_id:186,name:"AQ: ANTARCTIC AUS TERRITORY"},{_id:187,name:"CX: CHRISTMAS ISLAND"},{_id:188,name:"CC: COCOS ISLAND"},{_id:189,name:"BN: BRUNEI DARUSSALAM"},{_id:190,name:"NR: NAURU"},{_id:191,name:"PG: PAPUA NEW GUINEA"},{_id:192,name:"TO: TONGO"},{_id:193,name:"SB: SOLOM ISLANDS"},{_id:194,name:"VU: VANUATU"},{_id:195,name:"FJ: FIJI"},{_id:196,name:"CK: COOK ISLANDS"},{_id:197,name:"AS: AMERICAN SAMOA"},{_id:198,name:"WS: SAMOA"},{_id:199,name:"KI: KIRIBATI"},{_id:200,name:"NC: NEW CALEDONIA"},{_id:201,name:"TV: TUVALU"},{_id:202,name:"PF: FRENCH POLYNESIA"},{_id:203,name:"FM: MICRONESIA"},{_id:204,name:"MH: MARSHALL ISLANDS"},{_id:205,name:"KZ: KAZAKHSTAN"},{_id:206,name:"KG: KYRGYZSTAN"},{_id:207,name:"RU: RUSSIA"},{_id:208,name:"TJ: TAJIKISTAN"},{_id:209,name:"TM: TURKMENISTAN"},{_id:210,name:"UZ: UZBEKISTAN"},{_id:211,name:"BB: BARBADOS"},{_id:212,name:"JP: JAPAN"},{_id:213,name:"KR: KOREA, REPUBLIC OF"},{_id:214,name:"GB: UNITED KINGDOM"},{_id:215,name:"VN: VIETNAM"},{_id:216,name:"KP: KOREA (NORTH)"},{_id:217,name:"HK: HONG KONG"},{_id:218,name:"MO: MACAO"},{_id:219,name:"KH: CAMBODIA"},{_id:220,name:"LA: LAOS"},{_id:221,name:"CN: CHINA"},{_id:222,name:"TW: TAIWAN"},{_id:223,name:"BD: BANGLADESH"},{_id:224,name:"TR: TURKEY"},{_id:225,name:"IN: INDIA"},{_id:226,name:"PK: PAKISTAN"},{_id:227,name:"AF: AFGHANISTAN"},{_id:228,name:"LK: SRI LANKA"},{_id:229,name:"MM: MYANMAR(BURMA)"},{_id:230,name:"MV: MALDIVES"},{_id:231,name:"LB: LEBANON"},{_id:232,name:"JO: JORDAN"},{_id:233,name:"SY: SYRIA"},{_id:234,name:"IQ: IRAQ"},{_id:235,name:"KW: KUWAIT"},{_id:236,name:"SA: SAUDI ARABIA"},{_id:237,name:"YE: YEMEN"},{_id:238,name:"OM: OMAN"},{_id:239,name:"AE: UNITED ARAB EMIRATES"},{_id:240,name:"IL: ISRAEL"},{_id:241,name:"BH: BAHRAIN"},{_id:242,name:"QA: QATAR"},{_id:243,name:"BT: BHUTAN"},{_id:244,name:"MN: MONGOLIA"},{_id:245,name:"NP: NEPAL"},{_id:246,name:"IR: IRAN"},{_id:247,name:"AZ: AZERBAIJAN"},{_id:248,name:"GE: GEORGIA"},{_id:249,name:"EU: EUROPEAN UNION"},{_id:250,name:"MD: MOLDOVA"}],Mi=Qi;var qi=["DateCode"],Wi=["countMethodError"],ji=["holdInput"],$i=["quantity"];function Ki(n,t){n&1&&(m(0,"div"),I(1,"nz-skeleton-element",52)(2,"nz-skeleton-element",53),d()),n&2&&(a(1),l("nzActive",!0),a(1),l("nzActive",!0))}function Yi(n,t){if(n&1){let s=ke();m(0,"div")(1,"div",31)(2,"button",54),_("click",function(){ae(s);let i=S();return se(i.print())}),p(3," Print ITN "),d()(),I(4,"img",55),d()}if(n&2){let s=S();a(2),l("nzLoading",s.isLoading),a(2),l("nzSrc",s.imgURL)}}function Ji(n,t){n&1&&(m(0,"span",56),p(1,"Yes"),d())}function Zi(n,t){n&1&&(m(0,"span",57),p(1,"No"),d())}function Xi(n,t){if(n&1&&(m(0,"div"),I(1,"input",58),p(2),d()),n&2){let s=t.$implicit;a(1),l("value",s.id),a(1),He(" ",s.name," ")}}function en(n,t){if(n&1&&I(0,"nz-option",59),n&2){let s=t.$implicit;l("nzLabel",s.name)("nzValue",s._id)}}function tn(n,t){if(n&1&&(m(0,"div"),I(1,"input",60,61),m(3,"label",62)(4,"div",63)(5,"div",64),p(6),d()()()()),n&2){let s=t.$implicit;a(1),ut("id","countMethod",s.id,""),Rt("value",s.content),a(2),ut("for","countMethod",s.id,""),a(3),He(" ",s.content," ")}}function nn(n,t){if(n&1&&(m(0,"nz-form-item",31)(1,"nz-form-control",65),I(2,"nz-alert",66),d()()),n&2){let s=S();a(1),l("nzSpan",6)("nzOffset",4),a(1),l("nzType",s.alertType==="error"?"error":s.alertType==="success"?"success":s.alertType==="info"?"info":"warning")("nzMessage",s.alertMessage)}}function rn(n,t){if(n&1&&(m(0,"div",69)(1,"label"),I(2,"input",70,71),p(4),d()()),n&2){let s=t.$implicit;a(2),l("value",s.id),a(2),He(" ",s.content," ")}}function on(n,t){if(n&1){let s=ke();Qe(0),m(1,"form",18),_("ngSubmit",function(){ae(s);let i=S();return se(i.onSubmit())}),h(2,rn,5,2,"div",67),m(3,"span",68),p(4,"Option has to be selected"),d(),m(5,"button",48),_("click",function(){ae(s);let i=S();return se(i.onHold())}),p(6," Hold "),d()(),Ve()}if(n&2){let s=S();a(1),l("formGroup",s.holdForm),a(1),l("ngForOf",s.holdOptions),a(3),l("nzLoading",s.isLoading)}}var st=(()=>{let t=class t{COOFilter(r,i){let e=[];return i.length<3?(r.map(o=>{i.toUpperCase()===o.name.substring(0,i.length)&&e.push(o)}),e):(r.map(o=>{o.name.substring(4,4+i.length)===i.toUpperCase()&&e.push(o)}),e)}constructor(r,i,e,o,u,f,N,v,O,Re,Pe){this.fb=r,this.router=i,this._printer=e,this.qcService=o,this.updateAfterQc=u,this.fetchProductInfoFromMerp=f,this.printITN=N,this.holdQCOrder=v,this.insertEventLog=O,this._userInfo=Re,this.evenLog=Pe,this.imgURL="https://www.onlinecomponents.com/images/parts/largeimages/",this.productURL="https://www.onlinecomponents.com/en/grayhill/",this.specSheetURL="https://www.onlinecomponents.com/en/datasheet/",this.isLoading=!1,this.isInit=!0,this.alertType="error",this.alertMessage="",this.isEditable=!1,this.UnitOfMeasure="loading",this.printITN$=new we,this.productInfo$=new we,this.countryData=Mi,this.countMethods=[{id:1,content:"Factory bag"},{id:2,content:"Factory box"},{id:3,content:"Hand count"},{id:4,content:"Reel/TUB"},{id:5,content:"Drypack"},{id:6,content:"Scale"},{id:7,content:"Factory Reel"}],this.booleanOptions=[{id:!0,name:"Yes"},{id:!1,name:"No"}],this.verifyPack=this.fb.group({dateCode:[{value:"",disabled:!0},[M.pattern(Zt)]],ROHS:[{value:"",disabled:!0},[M.required]],countryISO2:[{value:"",disabled:!0},[M.required]],countMethods:["",[M.required]]}),this.subscription=new de,this.holdVisible=!1,this.holdOptions=[{id:1,content:"Short Quantity"},{id:2,content:"Damaged"},{id:3,content:"Repackaging"},{id:4,content:"Wrong Parts"},{id:5,content:"Verify Quantity"},{id:6,content:"Mixed Parts"},{id:7,content:"Part Number Verification"},{id:8,content:"Kit Set"},{id:9,content:"Over Shipment"}],this.holdForm=this.fb.group({holdReason:["",M.required]}),this.type="",this.message=""}ngOnInit(){this.qcService.changeTab(["finish","finish","process","wait"]);let r=this.qcService.itemInfo;if(!r){this.router.navigate(["qc"]);return}r.CountryISO2=r.CountryISO2||"Unknown";let i=this.countryData.find(e=>e.name.substring(0,2)===r.CountryISO2);i||(i=this.countryData.find(e=>e.name==="UNKNOWN")),this.verifyPack.setValue({dateCode:r.DateCode||"",ROHS:r.ROHS,countMethods:"",countryISO2:i._id}),this.itemInfo=r,this.productInfo$=this.fetchProductInfoFromMerp.fetch({ProductList:[r.ProductCode.padEnd(3)+r.PartNumber]}).pipe(oe(e=>{if(e.data.fetchProductInfoFromMerp.length){this.UnitOfMeasure=e.data.fetchProductInfoFromMerp[0].UnitOfMeasure.trim(),this.MICPartNumber=e.data.fetchProductInfoFromMerp[0].MICPartNumber.trim();let o=e.data.fetchProductInfoFromMerp[0].HazardMaterialLevel.trim();this.HazardMaterialLevel=!(o==="N"||!o),this.imgURL=`${this.imgURL}${this.MICPartNumber}.jpg`,this.productURL=`${this.productURL}${r.PartNumber}-${this.MICPartNumber}.html`,this.specSheetURL=`${this.specSheetURL}${r.PartNumber}-${this.MICPartNumber}/`}return this.isInit=!1,e}),Q(e=>(this.isInit=!1,this.alertMessage=e,this.alertType=e,e)))}onSubmit(){if(this.alertMessage="",Number(this.quantityInput.nativeElement.value)!==this.itemInfo.Quantity){this.alertMessage="Input correct quantity!",this.alertType="error";return}if(this.verifyPack.invalid||this.isLoading){this.verifyPack.get("countMethods").errors&&this.countMethodError.nativeElement.classList.remove("hidden");return}this.countMethodError.nativeElement.classList.add("hidden");let r="";this.countryData.forEach(e=>{e._id===this.verifyPack.get("countryISO2").value&&(r=e.name)}),r==="UNKNOWN"?r="":r=r.substring(0,2),this.itemInfo.ROHS=this.verifyPack.get("ROHS").value,this.itemInfo.CountryISO2=r,this.itemInfo.DateCode=this.verifyPack.get("dateCode").value,this.itemInfo.CountMethod=this.verifyPack.get("countMethods").value,this.qcService.changeItemParams(this.itemInfo);let i=this.updateAfterQc.mutate({InventoryTrackingNumber:this.itemInfo.InventoryTrackingNumber,Inventory:{ROHS:this.itemInfo.ROHS,DateCode:this.itemInfo.DateCode}});this.isEditable&&this.subscription.add(i.subscribe({next:e=>{let o="",u="";if(e.data.updateInventory[0]||(o="error",u+="Fail to update SQL"),this.isLoading=!1,!o){this.router.navigate(["qc/repack"]);return}this.router.navigate(["qc"],{queryParams:{type:o,message:u}})},error:e=>{this.isLoading=!1,this.router.navigate(["qc"],{queryParams:{type:"error",message:`${this.itemInfo.InventoryTrackingNumber} failed
${e}`}})}})),this.router.navigate(["qc/repack"])}back(){this.router.navigate(["/qc"])}toggleEdit(){this.isEditable=!0,this.verifyPack.controls.ROHS.enable(),this.verifyPack.controls.dateCode.enable(),this.verifyPack.controls.countryISO2.enable(),this.dateCodeInput.nativeElement.select()}ngAfterViewInit(){this.quantityInput.nativeElement.select()}print(){this.alertMessage="",this.isLoading=!0,this.printITN$=this.printITN.mutate({InventoryTrackingNumber:this.itemInfo.InventoryTrackingNumber,Station:this._printer.printerStation}).pipe(V(r=>{if(r.data.printITNLabel.success)this.isLoading=!1,this.alertMessage="Print success.",this.alertType="success";else throw"Print failed: "+r.data.printITNLabel.message}),Q(r=>(this.isLoading=!1,this.alertMessage=r,this.alertType="error",re(r))))}open(){this.holdVisible=!0,re([]).pipe(zt(10)).subscribe(()=>{this.holdInput.nativeElement.select()})}close(){this.holdVisible=!1}onHold(){let r=this.holdForm.get("holdReason").value,i={OrderLineDetailID:this.itemInfo.OrderLineDetailID,InventoryTrackingNumber:this.itemInfo.InventoryTrackingNumber,Status:String(r).padStart(2,"3"),Station:this._printer.printerStation,StatusID:g.warehouseHold_ID};this.isLoading=!0,this.writeInfoToMerp(i)}writeInfoToMerp(r){let i=[{UserName:this._userInfo.userName,OrderNumber:this.itemInfo.OrderNumber,NOSINumber:this.itemInfo.NOSI,UserEventID:g.Event_QC_Hold,OrderLineNumber:this.itemInfo.OrderLineNumber,InventoryTrackingNumber:this.itemInfo.InventoryTrackingNumber,Message:`Hold on ${String(r.Status).padStart(2,"3")}`,CustomerNumber:this.itemInfo.CustomerNumber,CustomerTier:this.itemInfo.CustomerTier,DistributionCenter:this.itemInfo.DistributionCenter,PartNumber:this.itemInfo.PartNumber,ProductCode:this.itemInfo.ProductCode,ProductTier:this.itemInfo.ProductTier,Quantity:this.itemInfo.Quantity,ParentITN:this.itemInfo.ParentITN,ShipmentMethod:this.itemInfo.ShipmentMethod,ShipmentMethodDescription:this.itemInfo.ShipmentMethodDescription,WMSPriority:this.itemInfo.WMSPriority,Priority:this.itemInfo.Priority}],e=B(x({},this.evenLog.eventLog),{EventTypeID:g.Event_QC_Hold,Log:JSON.stringify(B(x({},JSON.parse(this.evenLog.eventLog.Log)),{Message:`Hold on ${String(r.Status).padStart(2,"3")}`}))});this.subscription.add(this.holdQCOrder.mutate(r).pipe(D(o=>{if(this.isLoading=!1,!o.data.holdQCOrder.success)throw`HOLDORDER api: ${o.data.holdQCOrder.message}
`;if(!o.data.updateOrderLineDetail)throw"Fail to update SQL";return this.type="warning",this.message=`${this.itemInfo.InventoryTrackingNumber} is on hold.`,this.insertEventLog.mutate({oldLogs:i,eventLogs:e})}),oe(()=>{this.router.navigate(["qc"],{queryParams:{type:this.type,message:this.message}})}),Q(o=>(this.router.navigate(["qc"],{queryParams:{type:"error",message:`${this.itemInfo.InventoryTrackingNumber} hold failed.
${o}`}}),this.isLoading=!1,o))).subscribe())}ngOnDestroy(){this.subscription.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(c(ve),c(q),c(Ze),c(T),c(li),c(ai),c(mi),c(di),c(Ce),c(fe),c(ze))},t.\u0275cmp=z({type:t,selectors:[["verify-pack"]],viewQuery:function(i,e){if(i&1&&(E(qi,5),E(Wi,5),E(ji,5),E($i,5)),i&2){let o;A(o=y())&&(e.dateCodeInput=o.first),A(o=y())&&(e.countMethodError=o.first),A(o=y())&&(e.holdInput=o.first),A(o=y())&&(e.quantityInput=o.first)}},standalone:!0,features:[L],decls:83,vars:27,consts:[[1,"flex","flex-col"],["nz-row","","nzGutter","16"],["nz-col","",3,"nzSpan"],[4,"ngIf"],["nzBordered",""],["nzTitle","ITN"],["nzTitle","PRC"],["nzTitle","Links"],[1,"grid","grid-cols-2"],["target","_blank",3,"href"],["nzTitle","PartNumber",3,"nzSpan"],["nzTitle","Quantity"],[1,"text-2xl","font-bold"],["nzTitle","HML"],["class","text-2xl text-red-500",4,"ngIf"],["class","text-2xl",4,"ngIf"],[1,"hidden"],["nzText","Order Line Detail"],["focusInvalidInput","",3,"formGroup","ngSubmit"],["nz-row","","nzGutter","8"],["nz-col","","nzSpan","6"],["nzFor","DateCode","nzSpan","8"],["nzSpan","16","nzHasFeedback","","nzErrorTip","Invalid DateCode!"],["type","text","nz-input","","nzSize","large","id","DateCode","placeholder","","formControlName","dateCode","autocomplete","off"],["DateCode",""],["nz-col","","nzSpan","8"],[1,"grid","grid-flow-row","justify-center"],["nzFor","DateCode"],[1,"grid","grid-cols-2","space-x-4","pt-1"],[4,"ngFor","ngForOf"],["nz-col","","nzSpan","10"],["nz-row",""],["nzFor","DateCode","nz-col","","nzSpan","10"],["formControlName","countryISO2","nz-col","","nzSpan","14","nzShowSearch","","nzAllowClear","","formControlName","countryISO2","nzPlaceHolder","Select a country"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","","nzSpan","4","nzOffset","4"],[1,"rounded-md","bg-yellow-500"],["nz-button","","type","button","nzGhost","",1,"w-full",3,"click"],["nz-col","","nzSpan","4","nzOffset","6"],[1,"rounded-md","bg-green-500"],["nzText","Count"],["nz-col","","nzSpan","4",1,"text-lg"],["nz-col","","nzSpan","8","type","number","nz-input","","nzSize","large","id","quantity","placeholder","","autocomplete","off"],["quantity",""],[1,"mt-5","grid","grid-cols-3","gap-3"],[1,"mt-4","hidden","text-lg","text-red-600"],["countMethodError",""],[1,"rounded-md","bg-gray-500"],["nz-button","","nzType","primary","type","submit",1,"w-full",3,"nzLoading","click"],["nz-row","",4,"ngIf"],["nzPlacement","left","nzTitle","Place an order on hold",3,"nzClosable","nzVisible","nzOnClose"],[4,"nzDrawerContent"],["nzType","button","nzSize","large",1,"mb-4",3,"nzActive"],["nzType","image",2,"width","400px",3,"nzActive"],["nz-button","","type","button",1,"w-full",3,"nzLoading","click"],["nz-image","","width","200px","height","200px","alt","ProductImage","nzFallback","assets/img/image-not-found.png",3,"nzSrc"],[1,"text-2xl","text-red-500"],[1,"text-2xl"],["type","radio","name","ROHS","formControlName","ROHS",3,"value"],[3,"nzLabel","nzValue"],["type","radio","name","countMethods","formControlName","countMethods","required","",1,"peer","hidden",3,"id","value"],["countMethods",""],[1,"inline-flex","w-full","cursor-pointer","items-center","justify-between","rounded-lg","border","border-gray-200","bg-white","p-5","text-gray-500","hover:bg-gray-100","hover:text-gray-600","peer-checked:border-blue-600","peer-checked:text-blue-600",3,"for"],[1,"block"],[1,"w-full","text-lg","font-semibold"],[3,"nzSpan","nzOffset"],["nzShowIcon","",1,"w-full",3,"nzType","nzMessage"],["class","block space-x-4 pb-2 pt-3",4,"ngFor","ngForOf"],["id","error",1,"fixed","hidden","text-sm","text-red-600"],[1,"block","space-x-4","pb-2","pt-3"],["type","radio","name","holdReason","formControlName","holdReason",3,"value"],["holdInput",""]],template:function(i,e){i&1&&(m(0,"div",0)(1,"div",1)(2,"div",2),h(3,Ki,3,2,"div",3)(4,Yi,5,2,"div",3),R(5,"async"),d(),m(6,"div",2)(7,"nz-descriptions",4)(8,"nz-descriptions-item",5),p(9),d(),m(10,"nz-descriptions-item",6),p(11),d(),m(12,"nz-descriptions-item",7)(13,"div",8)(14,"a",9),p(15,"Product"),d(),m(16,"a",9),p(17,"Spec sheet"),d()()(),m(18,"nz-descriptions-item",10),p(19),d(),m(20,"nz-descriptions-item",11)(21,"span",12),p(22),d()(),m(23,"nz-descriptions-item",13),h(24,Ji,2,0,"span",14)(25,Zi,2,0,"span",15),d()(),m(26,"p",16),p(27),R(28,"async"),d()()(),I(29,"nz-divider",17),m(30,"form",18),_("ngSubmit",function(){return e.onSubmit()}),m(31,"div",19)(32,"div",20)(33,"nz-form-item")(34,"nz-form-label",21),p(35,"DateCode"),d(),m(36,"nz-form-control",22),I(37,"input",23,24),d()()(),m(39,"div",25)(40,"nz-form-item",26)(41,"nz-form-label",27),p(42,"ROHS"),d(),m(43,"div",28),h(44,Xi,3,2,"div",29),d()()(),m(45,"div",30)(46,"nz-form-item",31)(47,"nz-form-label",32),p(48,"Country of Origin"),d(),m(49,"nz-select",33),h(50,en,1,2,"nz-option",34),d()()()(),m(51,"div",1)(52,"div",35)(53,"div",36)(54,"button",37),_("click",function(){return e.open()}),p(55," Hold "),d()()(),m(56,"div",38)(57,"div",39)(58,"button",37),_("click",function(){return e.toggleEdit()}),p(59," Edit "),d()()()(),I(60,"nz-divider",40),m(61,"div",1)(62,"span",41),p(63,"Quantity:"),d(),I(64,"input",42,43),d(),m(66,"div",44),h(67,tn,7,4,"div",29),d(),m(68,"span",45,46),p(70,"Must select a method"),d(),I(71,"nz-divider"),m(72,"nz-form-item",1)(73,"div",35)(74,"div",47)(75,"button",37),_("click",function(){return e.back()}),p(76," Cancel "),d()()(),m(77,"div",38)(78,"button",48),_("click",function(){return e.onSubmit()}),p(79," Submit "),d()()(),h(80,nn,3,4,"nz-form-item",49),d()(),m(81,"nz-drawer",50),_("nzOnClose",function(){return e.close()}),h(82,on,7,3,"ng-container",51),d()),i&2&&(a(2),l("nzSpan",4),a(1),l("ngIf",e.isInit),a(1),l("ngIf",P(5,23,e.productInfo$)),a(2),l("nzSpan",20),a(3),C(e.itemInfo.InventoryTrackingNumber),a(2),C(e.itemInfo.ProductCode),a(3),l("href",e.productURL,pt),a(2),l("href",e.specSheetURL,pt),a(2),l("nzSpan",24),a(1),C(e.itemInfo.PartNumber),a(3),Pt(" ",e.itemInfo.Quantity,"(",e.UnitOfMeasure,")"),a(2),l("ngIf",e.HazardMaterialLevel),a(1),l("ngIf",!e.HazardMaterialLevel),a(2),C(P(28,25,e.printITN$)),a(3),l("formGroup",e.verifyPack),a(14),l("ngForOf",e.booleanOptions),a(6),l("ngForOf",e.countryData),a(17),l("ngForOf",e.countMethods),a(11),l("nzLoading",e.isLoading),a(2),l("ngIf",e.alertMessage),a(1),l("nzClosable",!1)("nzVisible",e.holdVisible))},dependencies:[k,Y,w,b,be,ti,ii,ni,U,K,W,j,$,tt,Ci,ie,Oe,Me,De,Je,J,Se,Ie,$t,he,Ne,Kt,Ee,Z,ge,_e,G,ee,Te,ye,X,Ae,pe,et,_i,vi,F,te,Ke,Wt,qt,H],encapsulation:2});let n=t;return n})();var an=()=>({rows:3});function sn(n,t){n&1&&I(0,"nz-skeleton",8),n&2&&l("nzParagraph",qe(1,an))}function mn(n,t){if(n&1&&(m(0,"li")(1,"span"),p(2),d()()),n&2){let s=t.$implicit;a(2),C(s)}}function dn(n,t){if(n&1&&(m(0,"li")(1,"span"),p(2),d()()),n&2){let s=t.$implicit;a(2),C(s)}}function ln(n,t){if(n&1&&(m(0,"nz-descriptions",9)(1,"nz-descriptions-item",10)(2,"ul"),h(3,mn,3,1,"li",11),d()(),m(4,"nz-descriptions-item",12)(5,"ul"),h(6,dn,3,1,"li",11),d()()()),n&2){let s=S();a(3),l("ngForOf",s.orderComments),a(3),l("ngForOf",s.partComments)}}function cn(n,t){if(n&1&&I(0,"nz-alert",13),n&2){let s=S();l("nzType",s.alertType==="error"?"error":s.alertType==="success"?"success":s.alertType==="info"?"info":"warning")("nzMessage",s.alertMessage)}}var mt=(()=>{let t=class t{constructor(r,i,e,o,u){this.router=r,this.route=i,this.titleService=e,this.qcService=o,this.qcGlobalMessage=u,this.isLoading=!1,this.alertType="error",this.alertMessage="",this.globalMessage$=new we,this.orderComments=[],this.partComments=[],this.titleService.setTitle("qc/globalmessages")}ngOnInit(){let{CustomerNumber:r,DistributionCenter:i,OrderNumber:e,OrderLineNumber:o,PartNumber:u,ProductCode:f}=this.qcService.itemInfo;i||this.router.navigate(["qc"]),this.qcService.changeTab(["finish","process","wait","wait"]);let N={CustomerNumber:r,DistributionCenter:i,OrderNumber:e,OrderLineNumber:o.toString(),PartNumber:u,ProductCode:f};this.getGlobalMessage(N)}onSubmit(){this.router.navigate(["/qc/verifypack"],{queryParams:this.route.snapshot.queryParams})}getGlobalMessage(r){this.isLoading=!0,this.globalMessage$=this.qcGlobalMessage.fetch(r,{fetchPolicy:"no-cache"}).pipe(oe(i=>{this.orderComments=i.data.fetchOrderLineMessage.comments,this.partComments=i.data.fetchPartMessage.comments,this.orderComments.length===0&&this.partComments.length===0?this.onSubmit():this.qcService.changeGlobalMessages(i.data),this.isLoading=i.loading}),Q(i=>(this.isLoading=!1,this.alertType="error",this.alertMessage=i,Ct(i))))}onKeyDownHandler(r){r.key==="Enter"&&this.onSubmit()}ngOnDestroy(){}};t.\u0275fac=function(i){return new(i||t)(c(q),c($e),c(ue),c(T),c(si))},t.\u0275cmp=z({type:t,selectors:[["global-messages"]],hostBindings:function(i,e){i&1&&_("keydown",function(u){return e.onKeyDownHandler(u)},!1,Et)},standalone:!0,features:[L],decls:12,vars:7,consts:[[1,"container","py-6","px-10","grid","grid-flow-row","gap-4"],[3,"nzParagraph",4,"ngIf"],[1,"hidden"],["nzTitle","Global Message","nzBordered","",4,"ngIf"],["nz-row","","nzJustify","center"],["nz-col","","nzXs","20","nzSm","16","nzMd","12","nzLg","10","nzXl","8","nzXXl","6"],["nz-button","","type","submit","nzType","primary","nzSize","large",1,"w-full",3,"nzLoading","click"],["nzShowIcon","","class","w-full",3,"nzType","nzMessage",4,"ngIf"],[3,"nzParagraph"],["nzTitle","Global Message","nzBordered",""],["nzTitle","Order Line Messages"],[4,"ngFor","ngForOf"],["nzTitle","Part Messages"],["nzShowIcon","",1,"w-full",3,"nzType","nzMessage"]],template:function(i,e){i&1&&(m(0,"div",0),h(1,sn,1,2,"nz-skeleton",1),m(2,"p",2),p(3),R(4,"async"),d(),h(5,ln,7,2,"nz-descriptions",3),m(6,"div",4)(7,"div",5)(8,"nz-form-item",4)(9,"button",6),_("click",function(){return e.onSubmit()}),p(10," Submit "),d()(),h(11,cn,1,2,"nz-alert",7),d()()()),i&2&&(a(1),l("ngIf",e.isLoading),a(2),C(P(4,5,e.globalMessage$)),a(2),l("ngIf",!e.isLoading),a(4),l("nzLoading",e.isLoading),a(2),l("ngIf",e.alertMessage))},dependencies:[b,be,ri,ie,Oe,Me,pe,k,Y,w,G,ee,U,K,W,j,$,F,te,H],encapsulation:2});let n=t;return n})();var pn=["container"],un=["containerError"];function fn(n,t){n&1&&I(0,"div")}function In(n,t){n&1&&I(0,"div")}function hn(n,t){if(n&1&&(m(0,"nz-form-item",8),I(1,"nz-alert",17),d()),n&2){let s=S();a(1),l("nzType",s.alertType==="error"?"error":s.alertType==="success"?"success":s.alertType==="info"?"info":"warning")("nzMessage",s.alertMessage)}}var Nn=()=>({xxl:3,xl:2,lg:2,md:2,sm:2,xs:1}),dt=(()=>{let t=class t{constructor(r,i,e,o,u,f,N,v,O,Re,Pe,Ue,me){this.fb=r,this.router=i,this.titleService=e,this.qcService=o,this.verifyQCRepack=u,this.updateContainer=f,this.updateStatus=N,this.updateMerpLastLine=v,this.updateMerp=O,this.insertUserEventLog=Re,this.eventLog=Pe,this._userInfo=Ue,this._location=me,this.isLoading=!1,this.needSearch=!1,this.alertType="error",this.buttonStyles="bg-green-500",this.buttonLabel="submit",this.alertMessage="",this.containerForm=this.fb.group({container:["",[M.required,M.pattern(Yt)]]}),this.titleService.setTitle("qc/repack")}ngOnInit(){if(this.qcService.changeTab(["finish","finish","finish","process"]),this.itemInfo=this.qcService.itemInfo,!this.itemInfo){this.router.navigate(["qc"]);return}}ngAfterViewInit(){this.containerInput.nativeElement.select()}onSubmit(){if(this.alertMessage="",this.containerForm.invalid||this.needSearch)return;let r=this.containerForm.value.container;this.isLoading=!0;let i=0,e,o,u;this.submit$=this.verifyQCRepack.fetch({DistributionCenter:We.DistributionCenter,Barcode:r,OrderID:this.itemInfo.OrderID},{fetchPolicy:"no-cache"}).pipe(V(f=>{u=f.data.findContainer;let N=f.data.findOrder;if(!u)throw"This barcode is not exist.";if(!N)throw"This order is not exist.";if(u.ContainerTypeID!==g.toteType_ID)throw"This container is not a tote!";if(!N.ORDERLINEDETAILs.length)throw"This Order is not exist in OrderLineDetail.";u.INVENTORies.length&&u.INVENTORies.forEach(v=>{if(v.ORDERLINEDETAILs.length){if(v.ORDERLINEDETAILs[0].OrderID!==this.itemInfo.OrderID&&v.ORDERLINEDETAILs[0].StatusID<g.agOutComplete_ID)throw"This tote has other order item in it.";if(v.ORDERLINEDETAILs[0].OrderID===this.itemInfo.OrderID&&![g.warehouseHold_ID,g.qcComplete_ID].includes(v.ORDERLINEDETAILs[0].StatusID))throw"This tote is not in QC area."}}),N.ORDERLINEDETAILs.forEach(v=>{v.Inventory?.InventoryTrackingNumber!==this.itemInfo.InventoryTrackingNumber?v.StatusID<g.qcComplete_ID&&++i:e=v.Inventory.ContainerID})}),D(f=>{let N=f.data.findContainer,v=[{UserName:this._userInfo.userName,OrderNumber:this.itemInfo.OrderNumber,NOSINumber:this.itemInfo.NOSI,InventoryTrackingNumber:this.itemInfo.InventoryTrackingNumber,UserEventID:g.Event_QC_Done,OrderLineNumber:this.itemInfo.OrderLineNumber,Message:`Repack to ${r}`,CustomerNumber:this.itemInfo.CustomerNumber,CustomerTier:this.itemInfo.CustomerTier,DistributionCenter:this.itemInfo.DistributionCenter,PartNumber:this.itemInfo.PartNumber,ProductCode:this.itemInfo.ProductCode,ProductTier:this.itemInfo.ProductTier,Quantity:this.itemInfo.Quantity,ParentITN:this.itemInfo.ParentITN,ShipmentMethod:this.itemInfo.ShipmentMethod,ShipmentMethodDescription:this.itemInfo.ShipmentMethodDescription,WMSPriority:this.itemInfo.WMSPriority,Priority:this.itemInfo.Priority}],O=[B(x({},this.eventLog.eventLog),{EventTypeID:g.Event_QC_Done,Log:JSON.stringify(B(x({},JSON.parse(this.eventLog.eventLog.Log)),{Message:`Repack to ${r}`}))})];i||(v.push({UserName:this._userInfo.userName,OrderNumber:this.itemInfo.OrderNumber,NOSINumber:this.itemInfo.NOSI,UserEventID:g.Event_QC_OrderComplete,InventoryTrackingNumber:null,OrderLineNumber:this.itemInfo.OrderLineNumber,Message:null,CustomerNumber:this.itemInfo.CustomerNumber,CustomerTier:this.itemInfo.CustomerTier,DistributionCenter:this.itemInfo.DistributionCenter,PartNumber:null,ProductCode:null,ProductTier:null,Quantity:null,ParentITN:null,ShipmentMethod:this.itemInfo.ShipmentMethod,ShipmentMethodDescription:this.itemInfo.ShipmentMethodDescription,Priority:this.itemInfo.Priority,WMSPriority:null}),O.push(B(x({},this.eventLog.eventLog),{EventTypeID:g.Event_QC_OrderComplete,Log:JSON.stringify({OrderNumber:this.itemInfo.OrderNumber,NOSINumber:this.itemInfo.NOSI,OrderLineNumber:this.itemInfo.OrderLineNumber,CustomerNumber:this.itemInfo.CustomerNumber,CustomerTier:this.itemInfo.CustomerTier,DistributionCenter:this.itemInfo.DistributionCenter,ShipmentMethod:this.itemInfo.ShipmentMethod,ShipmentMethodDescription:this.itemInfo.ShipmentMethodDescription,Priority:this.itemInfo.Priority})}))),this.insertlogQuery=this.insertUserEventLog.mutate({oldLogs:v,eventLogs:O});let Re=this.updateContainer.mutate({ContainerID:N._id,Container:{Warehouse:"01",Row:"QC",Aisle:null,Section:null,Shelf:null,ShelfDetail:null}}),Pe=this.updateContainer.mutate({ContainerID:e,Container:{Warehouse:null,Row:null,Aisle:null,Section:null,Shelf:null,ShelfDetail:null}});o={updateTargetConatiner:Re,updateSourceConatiner:Pe},g.qcComplete_ID,N._id===e&&(delete o.updateTargetConatiner,delete o.updateSourceConatiner);let Ue=[];return N.INVENTORies.length&&(N.INVENTORies.forEach(me=>{me.ORDERLINEDETAILs[0]&&me.ORDERLINEDETAILs[0].OrderID!==this.itemInfo.OrderID&&me.ORDERLINEDETAILs[0].StatusID>=g.agOutComplete_ID&&Ue.push({User:this._userInfo.userName,ITN:me.InventoryTrackingNumber,BinLocation:"PACKING"})}),Ue.length&&(o.cleanContainerFromPrevOrder=this._location.mutate({ITNList:Ue}))),Object.keys(o).length===0?re(!0):xe(o)}),V(f=>{let N;if(f.updateTargetContainer&&!f.updateTargetContainer.data.updateContainer[0]&&(N+=`${this.itemInfo.InventoryTrackingNumber} Fail to update Target Container SQL`),f.updateSourceContainer&&!f.updateSourceContainer.data.updateContainer[0]&&(N+=`${this.itemInfo.InventoryTrackingNumber} Fail to update source Container SQL`),N)throw N}),D(()=>{let f=this.updateStatus.mutate({OrderLineDetailID:this.itemInfo.OrderLineDetailID,Status:g.qcComplete_ID}),N=this._location.mutate({ITNList:[{ITN:this.itemInfo.InventoryTrackingNumber,User:this._userInfo.userName,BinLocation:r}]});return xe({updateDetail:f,updateBin:N})}),V(f=>{if(!f.updateBin.data.changeItnListForMerp)throw`${this.itemInfo.InventoryTrackingNumber} Fail to update Binlocation in Merp`}),D(f=>{let N=this.updateMerp.mutate({InventoryTrackingNumber:this.itemInfo.InventoryTrackingNumber,DateCode:this.itemInfo.DateCode,CountryOfOrigin:this.itemInfo.CountryISO2,ROHS:this.itemInfo.ROHS?"Y":"N",CountMethod:this.itemInfo.CountMethod}),O={updateStatus:this.updateMerpLastLine.mutate({OrderNumber:this.itemInfo.OrderNumber,NOSINumber:this.itemInfo.NOSI,Status:"60",UserOrStatus:"AGGREGATION-IN"}),updatInfo:N};return i&&delete O.updateStatus,xe(O)}),D(f=>(this.type="info",this.message=`QC complete for ${this.itemInfo.InventoryTrackingNumber}`,f.updateStatus&&(this.type="success",this.message=`QC complete for ${this.itemInfo.InventoryTrackingNumber}
QC complete for Order ${this.itemInfo.OrderNumber}`),this.insertlogQuery)),oe(()=>{this.router.navigate(["/qc"],{queryParams:{type:this.type,message:this.message}})}),Q(f=>(this.isLoading=!1,this.alertType="error",this.alertMessage=f,this.containerInput.nativeElement.select(),f)))}};t.\u0275fac=function(i){return new(i||t)(c(ve),c(q),c(ue),c(T),c(ci),c(Xt),c(pi),c(fi),c(ui),c(Ce),c(ze),c(fe),c(ei))},t.\u0275cmp=z({type:t,selectors:[["repack"]],viewQuery:function(i,e){if(i&1&&(E(pn,5),E(un,5)),i&2){let o;A(o=y())&&(e.containerInput=o.first),A(o=y())&&(e.containerError=o.first)}},standalone:!0,features:[L],decls:27,vars:15,consts:[[1,"flex","flex-col"],[4,"ngIf"],["nzBordered","",3,"nzColumn"],["nzTitle","ITN"],["nzTitle","PRC"],["nzTitle","PartNumber"],["nzText","Pick a empty container."],["nz-form","","focusInvalidInput","",3,"formGroup","ngSubmit"],["nz-row","","nzJustify","center"],["nz-col","","nzXs","20","nzSm","16","nzMd","12","nzLg","10","nzXl","8","nzXXl","6"],["nzRequired",""],["nzHasFeedback","","nzErrorTip","The input is not valid Container!"],["nz-input","","placeholder","Barcode#","nzSize","large","type","text","id","container","formControlName","container","autocomplete","off"],["container",""],["nz-col","","nzSpan","13"],["nz-button","","type","submit","nzType","primary","nzSize","large",1,"w-full",3,"nzLoading","disabled","click"],["nz-row","","nzJustify","center",4,"ngIf"],["nzShowIcon","",1,"w-full",3,"nzType","nzMessage"]],template:function(i,e){i&1&&(m(0,"div",0),h(1,fn,1,0,"div",1),R(2,"async"),h(3,In,1,0,"div",1),R(4,"async"),m(5,"nz-descriptions",2)(6,"nz-descriptions-item",3),p(7),d(),m(8,"nz-descriptions-item",4),p(9),d(),m(10,"nz-descriptions-item",5),p(11),d()(),I(12,"nz-divider",6),m(13,"form",7),_("ngSubmit",function(){return e.onSubmit()}),m(14,"div",8)(15,"div",9)(16,"nz-form-item",8)(17,"nz-form-label",10),p(18," Container "),d(),m(19,"nz-form-control",11),I(20,"input",12,13),d()(),m(22,"nz-form-item",8)(23,"div",14)(24,"button",15),_("click",function(){return e.onSubmit()}),p(25," Pack "),d()()(),h(26,hn,2,2,"nz-form-item",16),d()()()()),i&2&&(a(1),l("ngIf",P(2,10,e.fetchID$)),a(2),l("ngIf",P(4,12,e.submit$)),a(2),l("nzColumn",qe(14,Nn)),a(2),C(e.itemInfo.InventoryTrackingNumber),a(2),C(e.itemInfo.ProductCode),a(2),C(e.itemInfo.PartNumber),a(2),l("formGroup",e.containerForm),a(11),l("nzLoading",e.isLoading)("disabled",e.isLoading),a(2),l("ngIf",e.alertMessage))},dependencies:[b,ie,Oe,Me,De,Je,J,Se,Ie,he,Ne,G,Y,w,Ye,ee,Te,ye,Ee,Z,ge,_e,k,X,Ae,U,K,W,j,$,F,te,H],encapsulation:2});let n=t;return n})();var Sn=[{path:"",component:ot,children:[{path:"scanitn",component:at},{path:"globalmessages",component:mt},{path:"verifypack",component:st},{path:"repack",component:dt},{path:"",pathMatch:"full",redirectTo:"scanitn"}]}],Di=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=ce({type:t}),t.\u0275inj=le({imports:[ft.forChild(Sn),ft]});let n=t;return n})();function gn(n,t){}var _n=n=>({$implicit:n});function vn(n,t){if(n&1&&(m(0,"span",4),h(1,gn,0,0,"ng-template",5),d()),n&2){let s=S(),r=s.last,i=s.index,e=S();Be("margin-bottom",e.nzDirection==="vertical"?r?null:e.spaceSize:null,"px")("margin-right",e.nzDirection==="horizontal"?r?null:e.spaceSize:null,"px"),a(1),l("ngTemplateOutlet",e.nzSplit)("ngTemplateOutletContext",Ut(6,_n,i))}}function Cn(n,t){if(n&1&&(m(0,"div",1),Ot(1,2),d(),h(2,vn,2,8,"span",3)),n&2){let s=t.$implicit,r=t.last,i=S();Be("margin-bottom",i.nzDirection==="vertical"?r?null:i.spaceSize:null,"px")("margin-right",i.nzDirection==="horizontal"?r?null:i.spaceSize:null,"px"),a(1),l("ngTemplateOutlet",s),a(1),l("ngIf",i.nzSplit&&!r)}}var zn=["*"],An=(()=>{let t=class t{constructor(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=yt({type:t,selectors:[["","nzSpaceItem",""]]});let n=t;return n})(),yn="space",Li={small:8,middle:16,large:24},Le=class Le{constructor(t,s){this.nzConfigService=t,this.cdr=s,this._nzModuleName=yn,this.nzDirection="horizontal",this.nzSplit=null,this.nzWrap=!1,this.nzSize="small",this.spaceSize=Li.small,this.destroy$=new vt}updateSpaceItems(){let t=typeof this.nzSize=="string"?Li[this.nzSize]:this.nzSize;this.spaceSize=t/(this.nzSplit?2:1),this.cdr.markForCheck()}ngOnChanges(){this.updateSpaceItems(),this.mergedAlign=this.nzAlign===void 0&&this.nzDirection==="horizontal"?"center":this.nzAlign}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}ngAfterContentInit(){this.updateSpaceItems(),this.items.changes.pipe(At(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}};Le.\u0275fac=function(s){return new(s||Le)(c(Qt),c(bt))},Le.\u0275cmp=z({type:Le,selectors:[["nz-space"],["","nz-space",""]],contentQueries:function(s,r,i){if(s&1&&kt(i,An,4,wt),s&2){let e;A(e=y())&&(r.items=e)}},hostAttrs:[1,"ant-space"],hostVars:14,hostBindings:function(s,r){s&2&&(Be("flex-wrap",r.nzWrap?"wrap":null),Mt("ant-space-horizontal",r.nzDirection==="horizontal")("ant-space-vertical",r.nzDirection==="vertical")("ant-space-align-start",r.mergedAlign==="start")("ant-space-align-end",r.mergedAlign==="end")("ant-space-align-center",r.mergedAlign==="center")("ant-space-align-baseline",r.mergedAlign==="baseline"))},inputs:{nzDirection:"nzDirection",nzAlign:"nzAlign",nzSplit:"nzSplit",nzWrap:"nzWrap",nzSize:"nzSize"},exportAs:["NzSpace"],features:[Tt],ngContentSelectors:zn,decls:2,vars:1,consts:[["ngFor","",3,"ngForOf"],[1,"ant-space-item"],[3,"ngTemplateOutlet"],["class","ant-space-split",3,"margin-bottom","margin-right",4,"ngIf"],[1,"ant-space-split"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(s,r){s&1&&(Dt(),Lt(0),h(1,Cn,3,6,"ng-template",0)),s&2&&(a(1),l("ngForOf",r.items))},dependencies:[pe,b,Gt],encapsulation:2,changeDetection:0});var lt=Le;ct([xt()],lt.prototype,"nzWrap",void 0);ct([Vt()],lt.prototype,"nzSize",void 0);var Ri=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=ce({type:t}),t.\u0275inj=le({imports:[Bt,je]});let n=t;return n})();var jo=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=ce({type:t,bootstrap:[ot]}),t.\u0275inj=le({providers:[T],imports:[je,Di,J,Z,X,Ht,U,G,F,ie,be,Xe,Ri,tt,De,et,Ke,Ni,at,nt,mt,st,dt]});let n=t;return n})();export{jo as QualityControlModule};
