import{a as $}from"./chunk-ZT2YDPTR.js";import{d as L}from"./chunk-4DSMIZLG.js";import{a as U,b as l}from"./chunk-RMDJVRJE.js";import"./chunk-KI3MUNGW.js";import"./chunk-JOHRHLSX.js";import"./chunk-OXQW4PMW.js";import"./chunk-6DLKQNDK.js";import"./chunk-Z347V25R.js";import{G as x,I,e as u}from"./chunk-L3THJMBJ.js";import"./chunk-RAQ4VAB7.js";import"./chunk-FMSTYN27.js";import"./chunk-QQPJAVIB.js";import"./chunk-RMC6N2HF.js";import"./chunk-GJX7JKAF.js";import"./chunk-WX6KJXZ2.js";import"./chunk-EXQESRXT.js";import"./chunk-5FUULRSO.js";import"./chunk-C55YZZU5.js";import{a as O}from"./chunk-E6LDBMP7.js";import"./chunk-GFVCXK67.js";import"./chunk-WOYNEQEU.js";import"./chunk-XSY6ZNJP.js";import"./chunk-W3KGMJG7.js";import"./chunk-B3MPBRHZ.js";import"./chunk-YUDS3XHK.js";import"./chunk-MIXZFVL7.js";import"./chunk-FFJ3QZ3H.js";import"./chunk-PJEV5NXI.js";import{A as X,w as D}from"./chunk-GWV5DZOT.js";import{Da as v,Fb as k,Gb as s,Gc as y,H as h,Lc as T,Mc as w,Sb as b,V as C,ac as g,bc as F,cc as S}from"./chunk-N7LPRJLK.js";var N=(()=>{let r=class r{constructor(t,e,i){this._title=t,this.fb=e,this.fetchTaskCounter=i,this.filterForm=this.fb.group({module:["",[u.required]],timeRange:["",[u.required]]}),this.listOfColumn=[{title:"User",compare:(o,a)=>o.User.localeCompare(a.User)},{title:"Total",compare:(o,a)=>o.total-a.total}],this._title.update("Task Counting")}ngOnInit(){for(let t=0;t<24;t++){let e="";t<12&&(e=`${t}am`),t===12&&(e="12pm"),t>12&&(e=`${t-12}pm`),this.listOfColumn.push({title:e,compare:(i,o)=>i.taskCounter[t]-o.taskCounter[t]})}}resetForm(){this.filterForm.reset({module:"",timeRange:""})}onSubmit(){if(this.filterForm.invalid)return;let t=this.filterForm.get("timeRange").value,e=new Date(t.setHours(0,0,0,0)).toISOString();this.startDate=e;let i=new Date(t.setHours(23,59,59,999)).toISOString();this.fetchTable$=this.fetchTaskCounter.fetch({Module:this.filterForm.get("module").value,startDate:e,endDate:i},{fetchPolicy:"network-only"}).pipe(h(o=>{let a=0,c=new Array(24).fill(0),p=o.data.fetchTaskCounter.filter(n=>n!==null).map(n=>{let f=n.taskCounter.reduce((M,d,_)=>(c[_]+=d,M+d));return a+=f,{User:n.User,total:f,taskCounter:n.taskCounter}});return p.push({User:"Total",total:a,taskCounter:c}),p}),C(o=>o))}exportexcel(){let t=document.getElementById("table-view"),e=l.table_to_sheet(t),i=l.book_new();l.book_append_sheet(i,e,"Sheet1"),U(i,`${this.filterForm.get("EventType").value.replace(" ","")}${this.startDate.substring(0,10)}.xlsx`)}};r.\u0275fac=function(e){return new(e||r)(s(O),s(x),s(L))},r.\u0275cmp=v({type:r,selectors:[["task-counter"]],standalone:!0,features:[y],decls:3,vars:4,consts:[[1,"container","mx-auto","px-4","py-4"],[3,"listOfColumn","data"]],template:function(e,i){e&1&&(g(0,"div",0),S(1,"table-view",1),T(2,"async"),F()),e&2&&(k(1),b("listOfColumn",i.listOfColumn)("data",w(2,2,i.fetchTable$)))},dependencies:[I,X,D,$],encapsulation:2});let m=r;return m})();export{N as TaskCounterComponent};
