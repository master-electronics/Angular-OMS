import{a as W}from"./chunk-ZL6MQR3Z.js";import{a as J}from"./chunk-XMFOCRFG.js";import"./chunk-JC3J4WKG.js";import{a as K}from"./chunk-W6X5OBKE.js";import{a as D}from"./chunk-PTORZITP.js";import{a as H}from"./chunk-RMIKNTFD.js";import"./chunk-ZOYJBT7K.js";import{a as z}from"./chunk-D3FIXZL7.js";import"./chunk-ADHMVREX.js";import"./chunk-IPTX4HSO.js";import{a as P}from"./chunk-VJKYRYVM.js";import{a as q}from"./chunk-OQTOI2SX.js";import"./chunk-O3UEHWS5.js";import"./chunk-KSUYRJTQ.js";import"./chunk-M47XUQY5.js";import"./chunk-YPJKXAYS.js";import"./chunk-I3G2JKLN.js";import"./chunk-LCEARWCQ.js";import"./chunk-4AGTE6D3.js";import"./chunk-5GWOD35Y.js";import"./chunk-MZCJXFXF.js";import{E as j,H as G,I as R,e as M,i as L,p as O,t as $}from"./chunk-L3THJMBJ.js";import"./chunk-PLQ7TNCQ.js";import"./chunk-C55YZZU5.js";import"./chunk-MIXZFVL7.js";import"./chunk-FFJ3QZ3H.js";import{k as E}from"./chunk-PJEV5NXI.js";import{A as V,q as x,w as A}from"./chunk-GWV5DZOT.js";import{$b as U,C as v,Da as N,Fb as p,Gb as u,Gc as w,H as d,Ia as _,Ja as f,Lc as b,Mc as S,Sb as a,V as I,ac as r,ba as k,bc as m,cc as C,dc as h,ec as g,gc as B,na as F,nc as s,pc as y,xc as T}from"./chunk-N7LPRJLK.js";function Y(o,n){if(o&1){let l=B();h(0),r(1,"auth-modal",10),s("clickClose",function(){_(l);let e=y();return f(e.popup=!1)})("passAuth",function(e){_(l);let t=y();return f(t.passAuth(e))}),m(),g()}}function Z(o,n){if(o&1&&(h(0),C(1,"message-bar",11),g()),o&2){let l=n.ngIf;p(1),a("message",l.message)("name",l.name)}}var Ct=(()=>{let n=class n{constructor(i,e,t,c,X){this._fb=i,this._router=e,this._update=t,this._step=c,this._country=X,this.popup=!1,this.inputForm=this._fb.group({country:["",[M.required],[this._update.countryValidator()]]})}ngOnInit(){this._step.changeSteps(2),this._update.initReceiptInfo(),this.countryList$=this.inputForm.valueChanges.pipe(d(i=>i.country),k(),F(i=>this._country.countryList$.pipe(d(e=>e.filter(t=>i.length?i.length<3?t.ISO2.includes(i.trim().toUpperCase()):i.length===3?t.ISO3.includes(i.trim().toUpperCase()):t.CountryName.trim().toLocaleUpperCase().includes(i.trim().toLocaleUpperCase()):!1)),d(e=>(this.countryInfo=e[0],e.slice(0,5).map(t=>({name:t.ISO2+" - "+t.ISO3+" - "+t.CountryName+" - "+t._id})))))))}onChange(i){this.inputForm.patchValue({country:i})}onSubmit(){if(this.countryInfo)this._update.updateCountry(this.countryInfo._id,this.countryInfo.ISO3);else{let[i,e,,t]=this.inputForm.value.country.split(" - ");if(!e||!t)return;this._update.updateCountry(Number(t),e)}if(this._update.receiptInfo.ISO3==="UNK"){this.popup=!0;return}this._router.navigateByUrl("receiptreceiving/update/datecode")}onBack(){this._router.navigateByUrl("receiptreceiving/part/quantity")}passAuth(i){this.data$=this._update.passAuthForNotApplicable$(i,"country").pipe(d(()=>(this._update.updateCountry(253,"UNK"),this._router.navigateByUrl("receiptreceiving/update/datecode"),null)),I(e=>v({error:{message:e.message,type:"error"}})))}};n.\u0275fac=function(e){return new(e||n)(u(j),u(E),u(K),u(q),u(D))},n.\u0275cmp=N({type:n,selectors:[["ng-component"]],standalone:!0,features:[w],decls:14,vars:9,consts:[[3,"formGroup","ngSubmit"],[1,"grid","grid-cols-3"],[1,"col-start-2","text-4xl"],["for","country",1,"mb-0.5","block","font-bold","text-gray-700"],["controlName","country",3,"dataSource","formSubmit"],[1,"grid","h-32","grid-cols-3","gap-10","text-2xl","md:mx-16","md:mt-10","md:h-64","md:text-4xl"],[3,"disabled"],[1,"col-start-3",3,"buttonClick"],["buttonText","Unknown",3,"buttonClick"],[4,"ngIf"],["message","Allow Unknown Country",3,"clickClose","passAuth"],[3,"message","name"]],template:function(e,t){e&1&&(r(0,"form",0),s("ngSubmit",function(){return t.onSubmit()}),r(1,"div",1)(2,"div",2)(3,"label",3),T(4," Country "),m(),r(5,"search-list-input",4),s("formSubmit",function(){return t.onSubmit()}),b(6,"async"),m()()(),r(7,"div",5),C(8,"submit-button",6),r(9,"normal-button",7),s("buttonClick",function(){return t.onBack()}),m(),r(10,"normal-button",8),s("buttonClick",function(){return t.popup=!0}),m()()(),U(11,Y,2,0,"ng-container",9)(12,Z,2,2,"ng-container",9),b(13,"async")),e&2&&(a("formGroup",t.inputForm),p(5),a("dataSource",S(6,5,t.countryList$)),p(3),a("disabled",t.inputForm.invalid),p(3),a("ngIf",t.popup),p(1),a("ngIf",S(13,7,t.data$)))},dependencies:[V,x,A,R,O,L,$,G,z,P,W,J,H],encapsulation:2});let o=n;return o})();export{Ct as CountryComponent};
