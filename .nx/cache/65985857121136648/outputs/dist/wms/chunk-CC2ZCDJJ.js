import{a as _e}from"./chunk-BZLYIZ6L.js";import{a as Ie}from"./chunk-RMIKNTFD.js";import"./chunk-ZOYJBT7K.js";import{a as ve}from"./chunk-D3FIXZL7.js";import"./chunk-ADHMVREX.js";import{a as he}from"./chunk-IPTX4HSO.js";import{a as be}from"./chunk-VJKYRYVM.js";import"./chunk-KSUYRJTQ.js";import"./chunk-FBU3NLE2.js";import"./chunk-MFWTQF6C.js";import"./chunk-M47XUQY5.js";import{a as se}from"./chunk-YPJKXAYS.js";import{a as b}from"./chunk-I3G2JKLN.js";import{i as ce}from"./chunk-LCEARWCQ.js";import{a as ee}from"./chunk-4AGTE6D3.js";import"./chunk-5GWOD35Y.js";import{d as pe,e as le}from"./chunk-POEXBOQJ.js";import{a as de,b as fe,c as ke,d as ge}from"./chunk-JOHRHLSX.js";import"./chunk-Z347V25R.js";import{E as me,I as O,d as ie,e as re,f as oe,h as ne,i as y,p as ae,t as x,u as ue}from"./chunk-L3THJMBJ.js";import"./chunk-GJX7JKAF.js";import"./chunk-5FUULRSO.js";import"./chunk-PLQ7TNCQ.js";import"./chunk-C55YZZU5.js";import"./chunk-B3MPBRHZ.js";import"./chunk-YUDS3XHK.js";import{n as te}from"./chunk-MIXZFVL7.js";import"./chunk-FFJ3QZ3H.js";import{k as Y,n as Z}from"./chunk-PJEV5NXI.js";import{A as C,p as W,q as N,w as X}from"./chunk-GWV5DZOT.js";import{$b as f,Bc as Q,C as L,Da as v,Fb as m,Gb as l,Gc as I,Hc as $,Ia as w,Ja as B,Lc as q,Mb as T,Mc as J,Sb as u,V as K,Vc as H,a as P,ac as s,b as E,bc as c,cc as k,dc as V,ec as G,gc as j,ka as M,na as z,nc as h,pc as g,qa as D,wc as A,xc as _,yc as U}from"./chunk-N7LPRJLK.js";function Se(e,i){if(e&1&&(s(0,"div")(1,"label",10),_(2),c()()),e&2){let a=i.$implicit;m(1),u("nzValue",a.value),m(1),U(a.content)}}function Re(e,i){e&1&&k(0,"textarea",11,12)}function Fe(e,i){e&1&&(s(0,"div")(1,"div")(2,"label",13),_(3,"Purchase Order"),c(),k(4,"input",14),c(),s(5,"div")(6,"label",15),_(7,"Part Number"),c(),k(8,"input",16),c()())}function Pe(e,i){if(e&1&&(V(0),k(1,"message-bar",17),G()),e&2){let a=g();m(1),u("message",a.data.error.message)("name",a.data.error.type)}}var Ne=(()=>{let i=class i{constructor(t){this.controlContainer=t,this.data={error:null},this.kickoutOptions=[],this.formSubmit=new T,this.formBack=new T}ngOnInit(){this.inputForm=this.controlContainer.control}onSubmit(){this.inputForm.valid&&(this.formSubmit.emit(),this.clean())}onBack(){this.formBack.emit()}clean(){this.inputForm.reset()}};i.\u0275fac=function(r){return new(r||i)(l(oe))},i.\u0275cmp=v({type:i,selectors:[["kickout-input-form"]],inputs:{data:"data",isShowInput:"isShowInput",kickoutOptions:"kickoutOptions"},outputs:{formSubmit:"formSubmit",formBack:"formBack"},standalone:!0,features:[I],decls:12,vars:6,consts:[[1,"text-4xl","md:mx-16",3,"formGroup","ngSubmit"],["id","kickoutReason","nzSize","large","formControlName","kickoutReason","name","kickoutReason"],["kickoutReason",""],[1,"mb-4","grid","grid-cols-3","justify-center","gap-5"],[4,"ngFor","ngForOf"],["id","otherReason","name","otherReason","formControlName","otherReason","rows","3","name","message","id","message","class","block w-full rounded-lg border border-gray-300 bg-gray-50 p-4 text-gray-900 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",4,"ngIf"],[4,"ngIf"],[1,"grid","h-16","grid-cols-3","text-2xl","md:mt-10","md:h-32","md:text-4xl"],[3,"disabled","buttonClick"],[3,"buttonClick"],["nz-radio-button","",3,"nzValue"],["id","otherReason","name","otherReason","formControlName","otherReason","rows","3","name","message","id","message",1,"block","w-full","rounded-lg","border","border-gray-300","bg-gray-50","p-4","text-gray-900","focus:border-blue-500","focus:ring-blue-500","dark:border-gray-600","dark:bg-gray-700","dark:text-white","dark:placeholder-gray-400","dark:focus:border-blue-500","dark:focus:ring-blue-500"],["otherReason",""],["for","purchaseOrder",1,"block","font-medium"],["autocomplete","off","formControlName","purchaseOrder","type","text","name","purchaseOrder","id","purchaseOrder",1,"focus:ring-primary-600","focus:border-primary-600","block","w-full","rounded-lg","border","bg-gray-50","p-2.5","text-gray-900"],["for","partNumber",1,"block","font-medium"],["autocomplete","off","formControlName","partNumber","type","text","name","partNumber","id","partNumber",1,"focus:ring-primary-600","focus:border-primary-600","block","w-full","rounded-lg","border","bg-gray-50","p-2.5","text-gray-900"],[3,"message","name"]],template:function(r,o){r&1&&(s(0,"form",0),h("ngSubmit",function(){return o.onSubmit()}),s(1,"nz-radio-group",1,2)(3,"div",3),f(4,Se,3,2,"div",4),c()(),f(5,Re,2,0,"textarea",5)(6,Fe,9,0,"div",6),s(7,"div",7)(8,"submit-button",8),h("buttonClick",function(){return o.onSubmit()}),c(),k(9,"div"),s(10,"normal-button",9),h("buttonClick",function(){return o.onBack()}),c()(),f(11,Pe,2,2,"ng-container",6),c()),r&2&&(u("formGroup",o.inputForm),m(4),u("ngForOf",o.kickoutOptions),m(1),u("ngIf",o.inputForm.value.kickoutReason===14),m(1),u("ngIf",o.isShowInput),m(2),u("disabled",o.inputForm.invalid),m(3),u("ngIf",o.data.error))},dependencies:[C,W,N,O,ae,ie,ne,y,x,ue,te,Ie,ve,be,ge,ke,de,fe],encapsulation:2});let e=i;return e})();function Ee(e,i){if(e&1&&(s(0,"p"),_(1),c()),e&2){let a=g(2);m(1),Q(" ITN: ",a._kickout.kickoutItns[a.index]," (",a.index+1," of ",a._kickout.kickoutItns.length,") ")}}function Le(e,i){if(e&1){let a=j();s(0,"div",2),f(1,Ee,2,3,"p",3),s(2,"kickout-input-form",4),h("formSubmit",function(){w(a);let r=g();return B(r.onSubmit())})("formBack",function(){w(a);let r=g();return B(r.onBack())}),c()()}if(e&2){let a=i.ngIf,t=g();m(1),u("ngIf",t._kickout.kickoutItns==null?null:t._kickout.kickoutItns.length),m(1),u("formGroup",t.kickoutForm)("isShowInput",!(t._kickout.kickoutItns!=null&&t._kickout.kickoutItns.length))("kickoutOptions",t.kickoutOptions)("data",a)}}var we=()=>({rows:8});function Be(e,i){e&1&&k(0,"nz-skeleton",5),e&2&&u("nzActive",!0)("nzParagraph",$(2,we))}var _t=(()=>{let i=class i{constructor(t,r,o,p,d,n,S){this._fb=t,this._router=r,this._receipt=o,this._kickout=p,this._insertLog=d,this._userInfo=n,this._eventLog=S,this.kickoutOptions=[{content:"Missing/Incorrect Picture",value:7},{content:"Missing/Incorrect Piece Kit",value:8},{content:"Part Number Verification",value:9},{content:"Date Code Verification",value:10},{content:"Wrong PO/No Open PO/No Open Line",value:11},{content:"Damaged Parts",value:12},{content:"Over PO Quantity",value:13},{content:"Other",value:14}],this.index=0,this.onChange=R=>{this.kickoutForm.get("otherReason").setValue(R)}}ngOnInit(){this.print$=L(!0),this.kickoutForm=this._fb.group({kickoutReason:["",re.required],otherReason:[""],purchaseOrder:[""],partNumber:[""]})}onBack(){if(this._kickout.kickoutItns){this._router.navigateByUrl("receiptreceiving/itnlist");return}this._router.navigateByUrl("receiptreceiving")}createLogs(t){if(this._receipt.receiptInfoAfterFilter()){let r=this._receipt.receiptInfoAfterFilter().map(n=>({UserName:this._userInfo.userName,InventoryTrackingNumber:this._kickout.kickoutItns[this.index],UserEventID:b.Event_Receiving_KickOut,ReceiptLine:n.ReceiptLineNumber,Quantity:n.ExpectedQuantity,PartNumber:n.PartNumber,ProductCode:n.ProductCodeNumber,ReceiptHeader:this._receipt.headerID(),PurchaseOrderNumber:n.PurchaseOrderNumber,PurchaseLine:n.PurchaseLineNumber,Message:t})),o=this._receipt.receiptInfoAfterFilter().map(n=>E(P({},this._eventLog.eventLog),{EventTypeID:b.Event_Receiving_KickOut,Log:JSON.stringify(E(P({},JSON.parse(this._eventLog.eventLog.Log)),{PartNumber:n.PartNumber,ProductCode:n.ProductCodeNumber,PurchaseOrderNumber:n.PurchaseOrderNumber,InventoryTrackingNumber:this._kickout.kickoutItns[this.index],ReceiptLine:n.ReceiptLineNumber,ExpectedQuantity:n.ExpectedQuantity,Reason:t}))})),p=this._kickout.kickoutItns[this.index],d=r[0].PurchaseOrderNumber;return{oldLogs:r,eventLogs:o,ITN:p,PurchaseOrder:d}}return{oldLogs:[{UserName:this._userInfo.userName,UserEventID:b.Event_Receiving_KickOut,PartNumber:this.kickoutForm.value.partNumber,PurchaseOrderNumber:this.kickoutForm.value.purchaseOrder,Message:t}],eventLogs:{UserName:this._userInfo.userName,EventTypeID:b.Event_Receiving_KickOut,Log:JSON.stringify({PartNumber:this.kickoutForm.value.partNumber,PurchaseOrderNumber:this.kickoutForm.value.purchaseOrder,Reason:t})},ITN:"",PurchaseOrder:this.kickoutForm.value.purchaseOrder}}onSubmit(){let{kickoutReason:t,otherReason:r}=this.kickoutForm.value,o=this.kickoutOptions[t-7]?.content,p=this._receipt.receiptInfoAfterFilter()?this._receipt.receiptInfoAfterFilter()[0].PurchaseOrderNumber.trim():this.kickoutForm.value.purchaseOrder+"|";t===14&&(o=o+": "+r),p+=o;let d=[];for(;d.length<4;){let F=p.substring(d.length*20,(d.length+1)*20);d.push(F)}let{oldLogs:n,eventLogs:S,ITN:R,PurchaseOrder:Ce}=this.createLogs(o);this.print$=this._kickout.printKickOutLabel$(d,t,R).pipe(z(()=>this._insertLog.mutate({oldLogs:n,eventLogs:S})),D(()=>{this.index++,!(this._kickout.kickoutItns?.length-this.index>0)&&this._router.navigate(["receiptreceiving"],{queryParams:{PurchaseOrder:Ce,name:"kickout"}})}),K(F=>L({error:{message:F.message,type:"error"}})),M(1))}};i.\u0275fac=function(r){return new(r||i)(l(me),l(Y),l(he),l(_e),l(ce),l(ee),l(se))},i.\u0275cmp=v({type:i,selectors:[["ng-component"]],standalone:!0,features:[I],decls:4,vars:4,consts:[["class","text-4xl md:mx-16",4,"ngIf","ngIfElse"],["loading",""],[1,"text-4xl","md:mx-16"],[4,"ngIf"],[3,"formGroup","isShowInput","kickoutOptions","data","formSubmit","formBack"],[3,"nzActive","nzParagraph"]],template:function(r,o){if(r&1&&(f(0,Le,3,5,"div",0),q(1,"async"),f(2,Be,1,3,"ng-template",null,1,H)),r&2){let p=A(3);u("ngIf",J(1,2,o.print$))("ngIfElse",p)}},dependencies:[C,N,X,Z,O,y,x,le,pe,Ne],encapsulation:2});let e=i;return e})();export{_t as KickoutItnComponent};
