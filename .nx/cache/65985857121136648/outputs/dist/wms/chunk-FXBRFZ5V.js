import{a as Z}from"./chunk-QTNYEYCW.js";import{b as Q}from"./chunk-CHDKWY6V.js";import"./chunk-CNRANGED.js";import{a as J}from"./chunk-GKR6SDXW.js";import{a as K}from"./chunk-XHQXBUEX.js";import"./chunk-RMIKNTFD.js";import"./chunk-D3FIXZL7.js";import"./chunk-ADHMVREX.js";import"./chunk-VJKYRYVM.js";import{l as q}from"./chunk-FBU3NLE2.js";import{e as U}from"./chunk-MFWTQF6C.js";import"./chunk-M47XUQY5.js";import{a as O}from"./chunk-I3G2JKLN.js";import"./chunk-LCEARWCQ.js";import{a as F}from"./chunk-4AGTE6D3.js";import"./chunk-5GWOD35Y.js";import"./chunk-POEXBOQJ.js";import{E as G,I as P,e as j,i as M,t as R}from"./chunk-L3THJMBJ.js";import{a as y}from"./chunk-PLQ7TNCQ.js";import"./chunk-C55YZZU5.js";import"./chunk-YUDS3XHK.js";import"./chunk-MIXZFVL7.js";import"./chunk-FFJ3QZ3H.js";import{i as z,k as $}from"./chunk-PJEV5NXI.js";import{A as B,q as x,w as E}from"./chunk-GWV5DZOT.js";import{$b as L,C,Da as k,Fb as s,Gb as c,Gc as w,H as D,Ia as d,Ja as S,Lc as I,Mc as N,Sb as a,V as T,ac as l,bc as f,cc as b,dc as g,ec as v,gc as h,na as A,nc as u,pc as p,qa as V}from"./chunk-N7LPRJLK.js";function Y(i,o){if(i&1){let n=h();g(0),l(1,"popup-modal",2),u("clickSubmit",function(){d(n);let t=p();return S(t.onBack())}),f(),v()}if(i&2){let n=p();s(1),a("message",n.message)}}function ee(i,o){if(i&1){let n=h();g(0),l(1,"popup-modal",3),u("clickSubmit",function(){d(n);let t=p();return S(t.zeroListOK())}),f(),v()}if(i&2){let n=p();s(1),a("message",n.zeroList)("cancelVisible",n.cancelVisible)}}function te(i,o){if(i&1){let n=h();g(0),l(1,"popup-modal",3),u("clickSubmit",function(){d(n);let t=p();return S(t.zeroListOK())}),f(),v()}if(i&2){let n=p();s(1),a("message",n.zeroList)("cancelVisible",n.cancelVisible)}}function ie(i,o){i&1&&b(0,"div")}function ne(i,o){i&1&&b(0,"div")}var Ie=(()=>{let o=class o{constructor(r,t,e,m,_,H,W,X){this._actRoute=r,this._router=t,this._fb=e,this._asn=m,this._eventLog=_,this._findContainer=H,this._userInfo=W,this._printer=X,this.inputForm=this._fb.nonNullable.group({location:["",[j.required]]}),this.cancelVisible=!1}ngOnInit(){this.data$=C(!0),this.asnID=null}onSubmit(){let r=JSON.parse(sessionStorage.getItem("asnContainer"));this.data$=this._findContainer.fetch({container:{Barcode:this.inputForm.value.location.toString()}},{fetchPolicy:"network-only"}).pipe(V(t=>{let e="test";if(!t.data.findContainer)throw new Error("Can't find this Location!")}),A(t=>this._asn.updateASNParentContainer(r._id,t.data.findContainer._id).pipe(D(e=>e))),A(t=>this._asn.sendToAutostore$(r.Barcode).pipe(D(e=>{let m="";e.ZeroList&&(e.ZeroList.forEach(_=>{_&&(m+=_.toString()+"<br />")}),this.zeroList="The following ITNs have zero quantity:<br />"+m),e.ASNID!="0"&&(this.print$=this._printer.printQRCode$(e.ASNID.toString()),this.log$=this._eventLog.insertLog([{UserEventID:O.Event_Autostore_ASN_Submitted,UserName:this._userInfo.userName,DistributionCenter:y.DistributionCenter,Message:"Location: "+r.Barcode+" ASNID: "+e.ASNID.toString()}],[{UserName:this._userInfo.userName,EventTypeID:O.Event_Autostore_ASN_Submitted,Log:JSON.stringify({DistributionCenter:y.DistributionCenter,Location:r.Barcode,ASNID:e})}])),e.ASNID&&e.ASNID!="0"&&(this.asnID=e.ASNID,this.message=`ASN '${e.ASNID.toString()}' created`),sessionStorage.removeItem("asnContainer")}))),T(t=>C({error:{message:t.message,type:"error"}})))}onBack(){this._router.navigate(["../../menu"],{relativeTo:this._actRoute})}zeroListOK(){this.zeroList=null,this.asnID||this._router.navigate(["../../menu"],{relativeTo:this._actRoute})}};o.\u0275fac=function(t){return new(t||o)(c(z),c($),c(G),c(Q),c(Z),c(U),c(F),c(q))},o.\u0275cmp=k({type:o,selectors:[["ng-component"]],standalone:!0,features:[w],decls:9,vars:14,consts:[["controlName","location","title","Scan ASN drop-off location:",3,"data","formGroup","isvalid","formSubmit","formBack"],[4,"ngIf"],[3,"message","clickSubmit"],[3,"message","cancelVisible","clickSubmit"]],template:function(t,e){t&1&&(l(0,"single-input-form",0),u("formSubmit",function(){return e.onSubmit()})("formBack",function(){return e.onBack()}),I(1,"async"),f(),L(2,Y,2,1,"ng-container",1)(3,ee,2,2,"ng-container",1)(4,te,2,2,"ng-container",1)(5,ie,1,0,"div",1),I(6,"async"),L(7,ne,1,0,"div",1),I(8,"async")),t&2&&(a("data",N(1,8,e.data$))("formGroup",e.inputForm)("isvalid",e.inputForm.valid),s(2),a("ngIf",e.message),s(1),a("ngIf",e.zeroList),s(1),a("ngIf",e.zeroList),s(1),a("ngIf",N(6,10,e.log$)),s(2),a("ngIf",N(8,12,e.print$)))},dependencies:[B,x,E,K,P,M,R,J],encapsulation:2});let i=o;return i})();export{Ie as ASNDropOffLocation};
